CREATE OR REPLACE VIEW mktg_ops_vws.bzfc_active_cnst_snpsht AS 
SELECT bzfc_active_cnst_snpsht.snpsht_dt, bzfc_active_cnst_snpsht.cnst_mstr_id, bzfc_active_cnst_snpsht.orig_cnst_mstr_id, bzfc_active_cnst_snpsht.cnst_typ_cd, bzfc_active_cnst_snpsht.active_fr_ind, bzfc_active_cnst_snpsht.active_fr_flg, bzfc_active_cnst_snpsht.active_no_trans_fr_ind, bzfc_active_cnst_snpsht.active_no_trans_fr_flg, bzfc_active_cnst_snpsht.active_all_trans_fr_ind, bzfc_active_cnst_snpsht.active_all_trans_fr_flg, bzfc_active_cnst_snpsht.fr_first_dntn_dt, bzfc_active_cnst_snpsht.fr_patronage_day_cnt, bzfc_active_cnst_snpsht.fr_last_dntn_dt, bzfc_active_cnst_snpsht.rolling_2yr_dntn_amt, bzfc_active_cnst_snpsht.fr_month_lapsed_ind, bzfc_active_cnst_snpsht.fr_new_cnst_ind, bzfc_active_cnst_snpsht.active_fr_mbl_ind, bzfc_active_cnst_snpsht.active_fr_mbl_flg, bzfc_active_cnst_snpsht.first_mbl_gift_dt, bzfc_active_cnst_snpsht.last_mbl_gift_dt, bzfc_active_cnst_snpsht.mbl_gift_cnt, bzfc_active_cnst_snpsht.mbl_gift_amt, bzfc_active_cnst_snpsht.active_bio_ind, bzfc_active_cnst_snpsht.active_bio_flg, bzfc_active_cnst_snpsht.active_no_trans_bio_ind, bzfc_active_cnst_snpsht.active_no_trans_bio_flg, bzfc_active_cnst_snpsht.active_all_trans_bio_ind, bzfc_active_cnst_snpsht.active_all_trans_bio_flg, bzfc_active_cnst_snpsht.first_bio_donat_dt, bzfc_active_cnst_snpsht.bio_patronage_day_cnt, bzfc_active_cnst_snpsht.last_donat_dt, bzfc_active_cnst_snpsht.rolling_2yr_proc_cnt, bzfc_active_cnst_snpsht.bio_month_lapsed_ind, bzfc_active_cnst_snpsht.bio_new_cnst_ind, bzfc_active_cnst_snpsht.active_vms_ind, bzfc_active_cnst_snpsht.active_vms_flg, bzfc_active_cnst_snpsht.first_vol_dt, bzfc_active_cnst_snpsht.vol_patronage_day_cnt, bzfc_active_cnst_snpsht.active_rcs_ind, bzfc_active_cnst_snpsht.active_rcs_flg, bzfc_active_cnst_snpsht.first_rcs_order_dt, bzfc_active_cnst_snpsht.rcs_patronage_day_cnt, bzfc_active_cnst_snpsht.last_rcs_order_dt, bzfc_active_cnst_snpsht.rcs_month_lapsed_ind, bzfc_active_cnst_snpsht.rcs_new_cnst_ind, bzfc_active_cnst_snpsht.active_dmw_ind, bzfc_active_cnst_snpsht.active_dmw_flg, bzfc_active_cnst_snpsht.active_dmw_course_ind, bzfc_active_cnst_snpsht.active_dmw_course_flg, bzfc_active_cnst_snpsht.active_dmw_store_ind, bzfc_active_cnst_snpsht.active_dmw_store_flg, bzfc_active_cnst_snpsht.first_dmw_order_dt, bzfc_active_cnst_snpsht.dmw_patronage_day_cnt, bzfc_active_cnst_snpsht.last_dmw_order_dt, bzfc_active_cnst_snpsht.active_phss_ind, bzfc_active_cnst_snpsht.active_phss_flg, bzfc_active_cnst_snpsht.active_phss_rcs_ind, bzfc_active_cnst_snpsht.active_phss_rcs_flg, bzfc_active_cnst_snpsht.first_crs_cmptn_dt, bzfc_active_cnst_snpsht.phss_patronage_day_cnt, bzfc_active_cnst_snpsht.last_crs_cmptn_dt, bzfc_active_cnst_snpsht.phss_month_lapsed_ind, bzfc_active_cnst_snpsht.phss_new_cnst_ind, bzfc_active_cnst_snpsht.active_cnst_ind, bzfc_active_cnst_snpsht.active_cnst_flg, bzfc_active_cnst_snpsht.active_all_trans_cnst_ind, bzfc_active_cnst_snpsht.active_all_trans_cnst_flg, bzfc_active_cnst_snpsht.multi_lob_ind, bzfc_active_cnst_snpsht.multi_lob_flg, bzfc_active_cnst_snpsht.multi_lob_all_trans_ind, bzfc_active_cnst_snpsht.multi_lob_all_trans_flg, CASE WHEN ((((((bzfc_active_cnst_snpsht.active_all_trans_fr_ind = 1) AND (COALESCE(bzfc_active_cnst_snpsht.last_donat_dt, bzfc_active_cnst_snpsht.first_vol_dt, bzfc_active_cnst_snpsht.last_dmw_order_dt, bzfc_active_cnst_snpsht.last_rcs_order_dt, bzfc_active_cnst_snpsht.last_crs_cmptn_dt, '1900-01-01'::date) <> '1900-01-01'::date)) OR ((bzfc_active_cnst_snpsht.active_all_trans_bio_ind = 1) AND (COALESCE(bzfc_active_cnst_snpsht.fr_last_dntn_dt, bzfc_active_cnst_snpsht.first_vol_dt, bzfc_active_cnst_snpsht.last_dmw_order_dt, bzfc_active_cnst_snpsht.last_rcs_order_dt, bzfc_active_cnst_snpsht.last_crs_cmptn_dt, '1900-01-01'::date) <> '1900-01-01'::date))) OR ((bzfc_active_cnst_snpsht.active_vms_ind = 1) AND (COALESCE(bzfc_active_cnst_snpsht.fr_last_dntn_dt, bzfc_active_cnst_snpsht.last_donat_dt, bzfc_active_cnst_snpsht.last_dmw_order_dt, bzfc_active_cnst_snpsht.last_rcs_order_dt, bzfc_active_cnst_snpsht.last_crs_cmptn_dt, '1900-01-01'::date) <> '1900-01-01'::date))) OR ((bzfc_active_cnst_snpsht.active_dmw_ind = 1) AND (COALESCE(bzfc_active_cnst_snpsht.fr_last_dntn_dt, bzfc_active_cnst_snpsht.last_donat_dt, bzfc_active_cnst_snpsht.first_vol_dt, '1900-01-01'::date) <> '1900-01-01'::date))) OR (bzfc_active_cnst_snpsht.multi_lob_all_trans_ind = 1)) THEN 1 ELSE 0 END AS active_multi_ever_ind, CASE WHEN ((((((bzfc_active_cnst_snpsht.active_all_trans_fr_ind = 1) AND (COALESCE(bzfc_active_cnst_snpsht.last_donat_dt, bzfc_active_cnst_snpsht.first_vol_dt, bzfc_active_cnst_snpsht.last_dmw_order_dt, bzfc_active_cnst_snpsht.last_rcs_order_dt, bzfc_active_cnst_snpsht.last_crs_cmptn_dt, '1900-01-01'::date) <> '1900-01-01'::date)) OR ((bzfc_active_cnst_snpsht.active_all_trans_bio_ind = 1) AND (COALESCE(bzfc_active_cnst_snpsht.fr_last_dntn_dt, bzfc_active_cnst_snpsht.first_vol_dt, bzfc_active_cnst_snpsht.last_dmw_order_dt, bzfc_active_cnst_snpsht.last_rcs_order_dt, bzfc_active_cnst_snpsht.last_crs_cmptn_dt, '1900-01-01'::date) <> '1900-01-01'::date))) OR ((bzfc_active_cnst_snpsht.active_vms_ind = 1) AND (COALESCE(bzfc_active_cnst_snpsht.fr_last_dntn_dt, bzfc_active_cnst_snpsht.last_donat_dt, bzfc_active_cnst_snpsht.last_dmw_order_dt, bzfc_active_cnst_snpsht.last_rcs_order_dt, bzfc_active_cnst_snpsht.last_crs_cmptn_dt, '1900-01-01'::date) <> '1900-01-01'::date))) OR ((bzfc_active_cnst_snpsht.active_dmw_ind = 1) AND (COALESCE(bzfc_active_cnst_snpsht.fr_last_dntn_dt, bzfc_active_cnst_snpsht.last_donat_dt, bzfc_active_cnst_snpsht.first_vol_dt, '1900-01-01'::date) <> '1900-01-01'::date))) OR (bzfc_active_cnst_snpsht.multi_lob_all_trans_ind = 1)) THEN 'Y'::text ELSE 'N'::text END AS active_multi_ever_flg, bzfc_active_cnst_snpsht.last_update_dt FROM mktg_ops_tbls.bzfc_active_cnst_snpsht WITH NO SCHEMA BINDING;