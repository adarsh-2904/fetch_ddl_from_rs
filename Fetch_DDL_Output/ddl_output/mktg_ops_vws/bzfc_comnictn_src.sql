CREATE OR REPLACE VIEW mktg_ops_vws.bzfc_comnictn_src AS 
SELECT "a"."comnictn_src_key" AS "comnictn_src_key", "a"."nk_comnictn_src_cd" AS "nk_comnictn_src_cd", "a"."comnictn_src_dsc" AS "comnictn_src_dsc", CASE WHEN "pg"."new_src_cd" IS NULL THEN "a"."nk_comnictn_src_cd" ELSE "pg"."new_src_cd" END AS "pg_nk_comnictn_src_cd", CASE WHEN "pg"."new_src_cd" IS NULL THEN "a"."comnictn_src_dsc" ELSE "pg"."new_src_dsc" END AS "pg_comnictn_src_dsc", "a"."nk_comnictn_src_cd" AS "orig_nk_comnictn_src_cd", "a"."comnictn_src_dsc" AS "orig_comnictn_src_dsc", "a"."comnicatn_src_cst_amt" AS "comnicatn_src_cst_amt", "a"."mrktng_activity_key" AS "mrktng_activity_key", "a"."mktcmpgn_typ_key" AS "mktcmpgn_typ_key", "a"."mrktng_initiative_key" AS "mrktng_initiative_key", "a"."mrktng_effort_num" AS "mrktng_effort_num", "a"."comnicatn_src_sgmnt_num" AS "comnicatn_src_sgmnt_num", "a"."fund_key" AS "fund_key", "a"."gl_debit_acct_key" AS "gl_debit_acct_key", "a"."gl_credit_acct_key" AS "gl_credit_acct_key", "a"."nk_ta_gl_debit_acct" AS "nk_ta_gl_debit_acct", "a"."nk_ta_gl_credit_acct" AS "nk_ta_gl_credit_acct", "a"."channel_typ_key" AS "channel_typ_key", "a"."mrktng_pckge_typ_key" AS "mrktng_pckge_typ_key", "a"."purpose_typ_key" AS "purpose_typ_key", "a"."mrktng_list_key" AS "mrktng_list_key", "a"."evnt_key" AS "evnt_key", "a"."mail_dt" AS "mail_dt", "a"."fcc_key" AS "fcc_key", "b"."mrktng_activity_cd" AS "mrktng_activity_cd", "b"."mrktng_activity_dsc" AS "mrktng_activity_dsc", "b"."mrktng_activity_typ_cd" AS "mrktng_activity_typ_cd", "b"."mrktng_activity_typ_dsc" AS "mrktng_activity_typ_dsc", "b"."mrktng_group_typ_cd" AS "mrktng_group_typ_cd", "b"."mrktng_group_typ_dsc" AS "mrktng_group_typ_dsc", "b"."mrktng_activity_act_ind" AS "mrktng_activity_act_ind", "c"."mrktng_initiative_cd" AS "mrktng_initiative_cd", "c"."mrktng_initiative_dsc" AS "mrktng_initiative_dsc", "d"."channel_typ_cd" AS "channel_typ_cd", "d"."channel_typ_dsc" AS "channel_typ_dsc", "e"."mktcmpgn_typ_cd" AS "mktcmpgn_typ_cd", "e"."mktcmpgn_typ_dsc" AS "mktcmpgn_typ_dsc", "f"."purpose_typ_cd" AS "purpose_typ_cd", "f"."purpose_typ_dsc" AS "purpose_typ_dsc", "g"."evnt_cd" AS "evnt_cd", "g"."evnt_dsc" AS "evnt_dsc", "g"."evnt_dt" AS "evnt_dt", "g"."evnt_typ_cd" AS "evnt_typ_cd", "g"."evnt_typ_dsc" AS "evnt_typ_dsc", "h"."fund_cd" AS "fund_cd", "h"."fund_dsc" AS "fund_dsc", "h"."fund_group_typ_cd" AS "fund_group_typ_cd", "h"."fund_group_typ_dsc" AS "fund_group_typ_dsc", "i"."mrktng_list_cd" AS "mrktng_list_cd", "i"."mrktng_list_dsc" AS "mrktng_list_dsc", "j"."mrktng_pckge_typ_cd" AS "mrktng_pckge_typ_cd", "j"."mrktng_pckge_typ_dsc" AS "mrktng_pckge_typ_dsc", CAST('TAFS' AS UNKNOWN) AS "appl_src_cd" FROM ((((((((("ddcoe_vws"."bz_comnictn_src" AS "a" LEFT JOIN (SELECT "pg_src_convrsn"."orig_src_cd" AS "orig_src_cd", "pg_src_convrsn"."orig_src_dsc" AS "orig_src_dsc", "pg_src_convrsn"."new_src_cd" AS "new_src_cd", "pg_src_convrsn"."new_src_dsc" AS "new_src_dsc" FROM "mktg_ops_tbls"."pg_src_convrsn" AS "pg_src_convrsn") AS "pg" ON "pg"."orig_src_cd" = "a"."nk_comnictn_src_cd") LEFT JOIN "ddcoe_vws"."bz_mrktng_activity" AS "b" ON "a"."mrktng_activity_key" = "b"."mrktng_activity_key") LEFT JOIN "ddcoe_vws"."bz_mrktng_initiative" AS "c" ON "a"."mrktng_initiative_key" = "c"."mrktng_initiative_key") LEFT JOIN "ddcoe_vws"."bz_channel_typ" AS "d" ON "a"."channel_typ_key" = "d"."channel_typ_key") LEFT JOIN "ddcoe_vws"."bz_mktcmpgn_typ" AS "e" ON "a"."mktcmpgn_typ_key" = "e"."mktcmpgn_typ_key") LEFT JOIN "ddcoe_vws"."bz_purpose_typ" AS "f" ON "a"."purpose_typ_key" = "f"."purpose_typ_key") LEFT JOIN "ddcoe_vws"."bz_evnt" AS "g" ON "a"."evnt_key" = "g"."evnt_key") LEFT JOIN "ddcoe_vws"."bz_fund" AS "h" ON "a"."fund_key" = "h"."fund_key") LEFT JOIN "ddcoe_vws"."bz_mrktng_list" AS "i" ON "a"."mrktng_list_key" = "i"."mrktng_list_key") LEFT JOIN "ddcoe_vws"."bz_mrktng_pckge_typ" AS "j" ON "a"."mrktng_pckge_typ_key" = "j"."mrktng_pckge_typ_key" QUALIFY ROW_NUMBER() OVER (PARTITION BY "a"."nk_comnictn_src_cd" ORDER BY "a"."srcsys_trans_ts" DESC NULLS FIRST) = CAST(1 AS INT4) WITH NO SCHEMA BINDING;