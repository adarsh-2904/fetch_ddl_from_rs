CREATE OR REPLACE VIEW mktg_ops_vws.bz_microsites_report AS 
SELECT subqry.page_nm, subqry.page_type, subqry.page_path, subqry.active, subqry.page_title, subqry.jcr_title, subqry.last_modified_by, subqry.last_publication_action, subqry.last_published_by, subqry.src_cd, subqry.sub_src_cd, subqry.donation_entity_url, subqry.page_id, subqry.thermometer_goal, subqry.thermometer_start_ts, subqry.thermometer_start_dt, subqry.counter_start_ts, subqry.counter_start_dt, subqry.page_create_start_ts, subqry.page_create_start_dt, subqry.last_publication_ts, subqry.last_publication_dt, subqry.start_ts, subqry.start_dt, subqry.designations FROM (SELECT DISTINCT msr.page_nm, msr.page_type, msr.page_path, COALESCE(msr.active, 'inactive'::character varying) AS active, msr.page_title, msr.jcr_title, msr.last_modified_by, msr.last_publication_action, msr.last_published_by, msr.src_cd, msr.sub_src_cd, msr.donation_entity_url, msr.page_id, msr.thermometer_goal, (((((((("right"((msr.thermometer_start_dt)::text, 4) || '-'::text) || CASE WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Jan'::text) THEN '01'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Feb'::text) THEN '02'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Mar'::text) THEN '03'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Apr'::text) THEN '04'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'May'::text) THEN '05'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Jun'::text) THEN '06'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Jul'::text) THEN '07'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Aug'::text) THEN '08'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Sep'::text) THEN '09'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Oct'::text) THEN '10'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Nov'::text) THEN '11'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Dec'::text) THEN '12'::text ELSE NULL::text END) || '-'::text) || "substring"((msr.thermometer_start_dt)::text, 9, 2)) || ' '::text) || "substring"((msr.thermometer_start_dt)::text, 12, 8)))::timestamp(0) without time zone - ('05:00:00')::interval hour) AS thermometer_start_ts, ((((((((("right"((msr.thermometer_start_dt)::text, 4) || '-'::text) || CASE WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Jan'::text) THEN '01'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Feb'::text) THEN '02'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Mar'::text) THEN '03'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Apr'::text) THEN '04'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'May'::text) THEN '05'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Jun'::text) THEN '06'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Jul'::text) THEN '07'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Aug'::text) THEN '08'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Sep'::text) THEN '09'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Oct'::text) THEN '10'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Nov'::text) THEN '11'::text WHEN ("substring"((msr.thermometer_start_dt)::text, 5, 3) = 'Dec'::text) THEN '12'::text ELSE NULL::text END) || '-'::text) || "substring"((msr.thermometer_start_dt)::text, 9, 2)) || ' '::text) || "substring"((msr.thermometer_start_dt)::text, 12, 8)))::timestamp(0) without time zone - ('05:00:00')::interval hour))::date AS thermometer_start_dt, (((((((("right"((msr.counter_start_dt)::text, 4) || '-'::text) || CASE WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Jan'::text) THEN '01'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Feb'::text) THEN '02'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Mar'::text) THEN '03'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Apr'::text) THEN '04'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'May'::text) THEN '05'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Jun'::text) THEN '06'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Jul'::text) THEN '07'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Aug'::text) THEN '08'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Sep'::text) THEN '09'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Oct'::text) THEN '10'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Nov'::text) THEN '11'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Dec'::text) THEN '12'::text ELSE NULL::text END) || '-'::text) || "substring"((msr.counter_start_dt)::text, 9, 2)) || ' '::text) || "substring"((msr.counter_start_dt)::text, 12, 8)))::timestamp(0) without time zone - ('05:00:00')::interval hour) AS counter_start_ts, ((((((((("right"((msr.counter_start_dt)::text, 4) || '-'::text) || CASE WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Jan'::text) THEN '01'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Feb'::text) THEN '02'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Mar'::text) THEN '03'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Apr'::text) THEN '04'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'May'::text) THEN '05'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Jun'::text) THEN '06'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Jul'::text) THEN '07'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Aug'::text) THEN '08'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Sep'::text) THEN '09'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Oct'::text) THEN '10'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Nov'::text) THEN '11'::text WHEN ("substring"((msr.counter_start_dt)::text, 5, 3) = 'Dec'::text) THEN '12'::text ELSE NULL::text END) || '-'::text) || "substring"((msr.counter_start_dt)::text, 9, 2)) || ' '::text) || "substring"((msr.counter_start_dt)::text, 12, 8)))::timestamp(0) without time zone - ('05:00:00')::interval hour))::date AS counter_start_dt, (((((((("right"((msr.page_creation_start_dt)::text, 4) || '-'::text) || CASE WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Jan'::text) THEN '01'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Feb'::text) THEN '02'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Mar'::text) THEN '03'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Apr'::text) THEN '04'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'May'::text) THEN '05'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Jun'::text) THEN '06'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Jul'::text) THEN '07'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Aug'::text) THEN '08'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Sep'::text) THEN '09'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Oct'::text) THEN '10'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Nov'::text) THEN '11'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Dec'::text) THEN '12'::text ELSE NULL::text END) || '-'::text) || "substring"((msr.page_creation_start_dt)::text, 9, 2)) || ' '::text) || "substring"((msr.page_creation_start_dt)::text, 12, 8)))::timestamp(0) without time zone - ('05:00:00')::interval hour) AS page_create_start_ts, ((((((((("right"((msr.page_creation_start_dt)::text, 4) || '-'::text) || CASE WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Jan'::text) THEN '01'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Feb'::text) THEN '02'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Mar'::text) THEN '03'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Apr'::text) THEN '04'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'May'::text) THEN '05'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Jun'::text) THEN '06'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Jul'::text) THEN '07'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Aug'::text) THEN '08'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Sep'::text) THEN '09'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Oct'::text) THEN '10'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Nov'::text) THEN '11'::text WHEN ("substring"((msr.page_creation_start_dt)::text, 5, 3) = 'Dec'::text) THEN '12'::text ELSE NULL::text END) || '-'::text) || "substring"((msr.page_creation_start_dt)::text, 9, 2)) || ' '::text) || "substring"((msr.page_creation_start_dt)::text, 12, 8)))::timestamp(0) without time zone - ('05:00:00')::interval hour))::date AS page_create_start_dt, (((((((("right"((msr.last_publicaion_dt)::text, 4) || '-'::text) || CASE WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Jan'::text) THEN '01'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Feb'::text) THEN '02'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Mar'::text) THEN '03'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Apr'::text) THEN '04'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'May'::text) THEN '05'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Jun'::text) THEN '06'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Jul'::text) THEN '07'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Aug'::text) THEN '08'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Sep'::text) THEN '09'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Oct'::text) THEN '10'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Nov'::text) THEN '11'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Dec'::text) THEN '12'::text ELSE NULL::text END) || '-'::text) || "substring"((msr.last_publicaion_dt)::text, 9, 2)) || ' '::text) || "substring"((msr.last_publicaion_dt)::text, 12, 8)))::timestamp(0) without time zone - ('05:00:00')::interval hour) AS last_publication_ts, ((((((((("right"((msr.last_publicaion_dt)::text, 4) || '-'::text) || CASE WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Jan'::text) THEN '01'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Feb'::text) THEN '02'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Mar'::text) THEN '03'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Apr'::text) THEN '04'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'May'::text) THEN '05'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Jun'::text) THEN '06'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Jul'::text) THEN '07'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Aug'::text) THEN '08'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Sep'::text) THEN '09'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Oct'::text) THEN '10'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Nov'::text) THEN '11'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Dec'::text) THEN '12'::text ELSE NULL::text END) || '-'::text) || "substring"((msr.last_publicaion_dt)::text, 9, 2)) || ' '::text) || "substring"((msr.last_publicaion_dt)::text, 12, 8)))::timestamp(0) without time zone - ('05:00:00')::interval hour))::date AS last_publication_dt, (((((((("right"((msr.start_dt)::text, 4) || '-'::text) || CASE WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Jan'::text) THEN '01'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Feb'::text) THEN '02'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Mar'::text) THEN '03'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Apr'::text) THEN '04'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'May'::text) THEN '05'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Jun'::text) THEN '06'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Jul'::text) THEN '07'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Aug'::text) THEN '08'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Sep'::text) THEN '09'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Oct'::text) THEN '10'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Nov'::text) THEN '11'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Dec'::text) THEN '12'::text ELSE NULL::text END) || '-'::text) || "substring"((msr.start_dt)::text, 9, 2)) || ' '::text) || "substring"((msr.start_dt)::text, 12, 8)))::timestamp(0) without time zone - ('05:00:00')::interval hour) AS start_ts, ((((((((("right"((msr.start_dt)::text, 4) || '-'::text) || CASE WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Jan'::text) THEN '01'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Feb'::text) THEN '02'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Mar'::text) THEN '03'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Apr'::text) THEN '04'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'May'::text) THEN '05'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Jun'::text) THEN '06'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Jul'::text) THEN '07'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Aug'::text) THEN '08'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Sep'::text) THEN '09'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Oct'::text) THEN '10'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Nov'::text) THEN '11'::text WHEN ("substring"((msr.start_dt)::text, 5, 3) = 'Dec'::text) THEN '12'::text ELSE NULL::text END) || '-'::text) || "substring"((msr.start_dt)::text, 9, 2)) || ' '::text) || "substring"((msr.start_dt)::text, 12, 8)))::timestamp(0) without time zone - ('05:00:00')::interval hour))::date AS start_dt, msr.designations, pg_catalog.row_number() OVER(  PARTITION BY msr.page_nm ORDER BY (((((((("right"((msr.last_publicaion_dt)::text, 4) || '-'::text) || CASE WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Jan'::text) THEN '01'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Feb'::text) THEN '02'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Mar'::text) THEN '03'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Apr'::text) THEN '04'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'May'::text) THEN '05'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Jun'::text) THEN '06'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Jul'::text) THEN '07'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Aug'::text) THEN '08'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Sep'::text) THEN '09'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Oct'::text) THEN '10'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Nov'::text) THEN '11'::text WHEN ("substring"((msr.last_publicaion_dt)::text, 5, 3) = 'Dec'::text) THEN '12'::text ELSE NULL::text END) || '-'::text) || "substring"((msr.last_publicaion_dt)::text, 9, 2)) || ' '::text) || "substring"((msr.last_publicaion_dt)::text, 12, 8)))::timestamp(0) without time zone - ('05:00:00')::interval hour) DESC) AS rn FROM data_lab_mktg_tbls.microsites_report msr) subqry WHERE (subqry.rn = 1) WITH NO SCHEMA BINDING;