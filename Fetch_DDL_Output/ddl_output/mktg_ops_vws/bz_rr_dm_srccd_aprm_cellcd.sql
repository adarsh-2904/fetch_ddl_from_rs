CREATE OR REPLACE VIEW mktg_ops_vws.bz_rr_dm_srccd_aprm_cellcd AS 
SELECT ranked_data.motivtn_cd, ranked_data.segmnt_dsc, ranked_data.kit_vrsn, ranked_data.mail_qnty, ranked_data.subsrc_cd, ranked_data.src_cd FROM (SELECT rr_dm_srccd_aprm_cellcd.motivtn_cd, rr_dm_srccd_aprm_cellcd.segmnt_dsc, rr_dm_srccd_aprm_cellcd.kit_vrsn, rr_dm_srccd_aprm_cellcd.mail_qnty, rr_dm_srccd_aprm_cellcd.subsrc_cd, rr_dm_srccd_aprm_cellcd.src_cd, rr_dm_srccd_aprm_cellcd.dw_trans_ts, pg_catalog.row_number() OVER(  PARTITION BY rr_dm_srccd_aprm_cellcd.motivtn_cd, rr_dm_srccd_aprm_cellcd.src_cd, rr_dm_srccd_aprm_cellcd.subsrc_cd ORDER BY rr_dm_srccd_aprm_cellcd.dw_trans_ts) AS rn FROM mktg_data_tbls.rr_dm_srccd_aprm_cellcd WHERE (((((rr_dm_srccd_aprm_cellcd.motivtn_cd)::text <> (rr_dm_srccd_aprm_cellcd.src_cd)::text) AND ("substring"((rr_dm_srccd_aprm_cellcd.motivtn_cd)::text, 9, 4) <> 'M000'::text)) AND ("substring"((rr_dm_srccd_aprm_cellcd.motivtn_cd)::text, 1, 2) = "substring"((rr_dm_srccd_aprm_cellcd.src_cd)::text, 1, 2))) AND (rr_dm_srccd_aprm_cellcd.row_stat_cd <> 'L'::bpchar))) ranked_data WHERE (ranked_data.rn = 1) WITH NO SCHEMA BINDING;