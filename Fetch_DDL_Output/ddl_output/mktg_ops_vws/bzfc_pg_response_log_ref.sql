CREATE OR REPLACE VIEW mktg_ops_vws.bzfc_pg_response_log_ref AS 
SELECT sub.pg_response_log_key, sub.first_response_dt, sub.org_nm, sub.clnsd_first_nm, sub.clnsd_last_nm, sub.clnsd_email_addr, sub.derived_campaign, sub.response_group_dsc, sub.cds_image_id, sub.frwl_gift_id, sub.src_cd, sub.hist_seqnum, sub.history_record_id, sub.pgc_response_id, sub.mds_unq_id, sub.dw_create_ts, sub.dw_trans_ts, sub.appl_src_cd, sub.row_insert_ts, sub.rn FROM (SELECT bzfc_pg_response_log_ref.pg_response_log_key, bzfc_pg_response_log_ref.first_response_dt, bzfc_pg_response_log_ref.org_nm, bzfc_pg_response_log_ref.clnsd_first_nm, bzfc_pg_response_log_ref.clnsd_last_nm, bzfc_pg_response_log_ref.clnsd_email_addr, bzfc_pg_response_log_ref.derived_campaign, bzfc_pg_response_log_ref.response_group_dsc, bzfc_pg_response_log_ref.cds_image_id, bzfc_pg_response_log_ref.frwl_gift_id, bzfc_pg_response_log_ref.src_cd, bzfc_pg_response_log_ref.hist_seqnum, bzfc_pg_response_log_ref.history_record_id, bzfc_pg_response_log_ref.pgc_response_id, bzfc_pg_response_log_ref.mds_unq_id, bzfc_pg_response_log_ref.dw_create_ts, bzfc_pg_response_log_ref.dw_trans_ts, bzfc_pg_response_log_ref.appl_src_cd, bzfc_pg_response_log_ref.row_insert_ts, pg_catalog.row_number() OVER(  PARTITION BY bzfc_pg_response_log_ref.first_response_dt, bzfc_pg_response_log_ref.org_nm, bzfc_pg_response_log_ref.clnsd_first_nm, bzfc_pg_response_log_ref.clnsd_last_nm, bzfc_pg_response_log_ref.clnsd_email_addr, bzfc_pg_response_log_ref.derived_campaign, bzfc_pg_response_log_ref.response_group_dsc, bzfc_pg_response_log_ref.cds_image_id, bzfc_pg_response_log_ref.frwl_gift_id, bzfc_pg_response_log_ref.src_cd, bzfc_pg_response_log_ref.hist_seqnum, bzfc_pg_response_log_ref.history_record_id, bzfc_pg_response_log_ref.pgc_response_id, bzfc_pg_response_log_ref.appl_src_cd ORDER BY bzfc_pg_response_log_ref.pg_response_log_key) AS rn FROM mktg_ops_tbls.bzfc_pg_response_log_ref) sub WHERE (sub.rn = 1) WITH NO SCHEMA BINDING;