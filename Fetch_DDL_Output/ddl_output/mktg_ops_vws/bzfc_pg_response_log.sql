CREATE OR REPLACE VIEW mktg_ops_vws.bzfc_pg_response_log AS 
(((((SELECT "b"."pg_response_log_key" AS "pg_response_log_key", "a"."clnsd_first_nm" AS "clnsd_first_nm", "a"."clnsd_last_nm" AS "clnsd_last_nm", "a"."clnsd_email_addr" AS "clnsd_email_addr", "a"."derived_campaign" AS "derived_campaign", "a"."first_response_dt" AS "first_response_dt", "a"."response_group_dsc" AS "response_group_dsc", "a"."response_cnt" AS "response_cnt", "a"."first_response_ts" AS "first_response_ts", "a"."match_lob_src" AS "match_lob_src", "a"."match_typ" AS "match_typ", "a"."cds_batch_number" AS "cds_batch_number", "a"."cds_sequence_number" AS "cds_sequence_number", "a"."response_ts_src" AS "response_ts_src", "a"."response_ts" AS "response_ts", "a"."response_dt" AS "response_dt", "a"."site_url" AS "site_url", CAST(CASE WHEN (pg_catalog.POSITION(BTRIM("a"."site_url"), CAST('source=' AS TEXT)) = CAST(0 AS INT4)) THEN CAST(NULL AS TEXT) ELSE pg_catalog.SUBSTRING(pg_catalog.SUBSTRING(BTRIM("a"."site_url"), pg_catalog.POSITION(BTRIM("a"."site_url"), CAST('source=' AS TEXT))), CAST(8 AS INT4), CASE WHEN (pg_catalog.POSITION(pg_catalog.SUBSTRING(BTRIM("a"."site_url"), pg_catalog.POSITION(BTRIM("a"."site_url"), CAST('source=' AS TEXT))), CAST('&' AS TEXT)) = CAST(0 AS INT4)) THEN CAST(10 AS INT4) ELSE (pg_catalog.POSITION(pg_catalog.SUBSTRING(BTRIM("a"."site_url"), pg_catalog.POSITION(BTRIM("a"."site_url"), CAST('source=' AS TEXT))), CAST('&' AS TEXT)) - CAST(8 AS INT4)) END) END AS VARCHAR) AS "site_src", "a"."lander_type" AS "lander_type", "a"."nk_ecode" AS "nk_ecode", "a"."src_cd_src" AS "src_cd_src", CASE WHEN (("a"."scr_cd" = CAST('APP20091M000' AS TEXT)) AND ("a"."response_dt" >= CAST('2021-09-07' AS DATE))) THEN CAST('APP21091M000' AS VARCHAR) WHEN (("a"."scr_cd" = CAST('APP2308AE000' AS TEXT)) AND ("a"."response_dt" >= CAST('2024-07-31' AS DATE))) THEN CAST('APP2408AE000' AS VARCHAR) WHEN (("a"."scr_cd" = CAST('APP18092M000' AS TEXT)) AND ("a"."response_dt" >= CAST('2024-07-31' AS DATE))) THEN CAST('APP24082M000' AS VARCHAR) WHEN (("a"."scr_cd" = CAST('APP23082E000' AS TEXT)) AND ("a"."response_dt" >= CAST('2024-07-31' AS DATE))) THEN CAST('APP24082E000' AS VARCHAR) ELSE "a"."scr_cd" END AS "scr_cd", "a"."cnst_mstr_id_src" AS "cnst_mstr_id_src", "a"."cnst_mstr_id" AS "cnst_mstr_id", "a"."orig_cnst_mstr_id" AS "orig_cnst_mstr_id", "a"."ttl" AS "ttl", "a"."first_nm" AS "first_nm", "a"."middle_nm" AS "middle_nm", "a"."last_nm" AS "last_nm", "a"."sfx" AS "sfx", "a"."prf_ttl" AS "prf_ttl", "a"."cmpny_nm" AS "cmpny_nm", "a"."birth_dt_src" AS "birth_dt_src", CASE WHEN ((pg_catalog.DATE_PART(CAST('year' AS TEXT), "a"."birth_dt") >= CAST(0 AS INT4)) AND (pg_catalog.DATE_PART(CAST('year' AS TEXT), "a"."birth_dt") <= CAST(99 AS INT4))) THEN DATE_ADD(CAST('month' AS TEXT), CAST(22800 AS INT4), "a"."birth_dt") ELSE "a"."birth_dt" END AS "birth_dt", "a"."spouse_birth_dt_src" AS "spouse_birth_dt_src", CASE WHEN ((pg_catalog.DATE_PART(CAST('year' AS TEXT), "a"."spouse_birth_dt") >= CAST(0 AS INT4)) AND (pg_catalog.DATE_PART(CAST('year' AS TEXT), "a"."spouse_birth_dt") <= CAST(99 AS INT4))) THEN DATE_ADD(CAST('month' AS TEXT), CAST(22800 AS INT4), "a"."spouse_birth_dt") ELSE "a"."spouse_birth_dt" END AS "spouse_birth_dt", "a"."addr_ln1" AS "addr_ln1", "a"."addr_ln2" AS "addr_ln2", "a"."addr_ln3" AS "addr_ln3", "a"."city" AS "city", "a"."state" AS "state", "a"."zip_cd" AS "zip_cd", "a"."phone_num" AS "phone_num", "a"."phone_mobile_ind" AS "phone_mobile_ind", "a"."phone_home_ind" AS "phone_home_ind", "a"."email_addr" AS "email_addr", "a"."cntct_prfrnc" AS "cntct_prfrnc", COALESCE("a"."cntct_prfrnc_phone_ind", CAST(0 AS INT4)) AS "cntct_prfrnc_phone_ind", COALESCE("a"."cntct_prfrnc_text_ind", CAST(0 AS INT4)) AS "cntct_prfrnc_text_ind", COALESCE("a"."cntct_prfrnc_email_ind", CAST(0 AS INT4)) AS "cntct_prfrnc_email_ind", "a"."cdrp_pg_info_request_pg_information" AS "cdrp_pg_info_request_pg_information", "a"."cdrp_pg_confirm_arc_in_will" AS "cdrp_pg_confirm_arc_in_will", "a"."cga_age_payments_begin" AS "cga_age_payments_begin", "a"."cga_5000" AS "cga_5000", "a"."cga_10000" AS "cga_10000", "a"."cga_50000" AS "cga_50000", "a"."cga_100000" AS "cga_100000", "a"."cga_other" AS "cga_other", "a"."cga_fdbk" AS "cga_fdbk", "a"."wg_rqst" AS "wg_rqst", "a"."wg_arc_in_will" AS "wg_arc_in_will", "a"."wg_intend_arc_in_will" AS "wg_intend_arc_in_will", "a"."wg_consider_arc_in_will" AS "wg_consider_arc_in_will", "a"."wg_fdbk" AS "wg_fdbk", "a"."interest_in_life_income_gift_w_stock" AS "interest_in_life_income_gift_w_stock", "a"."interest_in_life_income_gift_w_real_estate" AS "interest_in_life_income_gift_w_real_estate", "a"."interest_in_life_income_gift_w_ira" AS "interest_in_life_income_gift_w_ira", "a"."interest_in_gift_in_will" AS "interest_in_gift_in_will", "a"."interest_in_gift_outside_will" AS "interest_in_gift_outside_will", "a"."interest_in_life_income_gifts" AS "interest_in_life_income_gifts", "a"."interest_in_ira_qcd_gifts" AS "interest_in_ira_qcd_gifts", "a"."consider_charity_in_will" AS "consider_charity_in_will", "a"."email_opt_in" AS "email_opt_in", "a"."giving_reason_arc_was_there_for_me" AS "giving_reason_arc_was_there_for_me", "a"."giving_reason_provide_general_support" AS "giving_reason_provide_general_support", "a"."giving_reason_respond_to_local_or_national_disasters_or_emergencies" AS "giving_reason_respond_to_local_or_national_disasters_or_emergencies", "a"."giving_reason_tax_purposes" AS "giving_reason_tax_purposes", "a"."giving_reason_believe_in_arc_mission" AS "giving_reason_believe_in_arc_mission", "a"."giving_reason_frnd_fmly_mbr_suprtr" AS "giving_reason_frnd_fmly_mbr_suprtr", "a"."influential_person_in_your_life" AS "influential_person_in_your_life", "a"."has_the_arc_brought_hope_and_help_to_your_family_or_community" AS "has_the_arc_brought_hope_and_help_to_your_family_or_community", "a"."arc_programs_health_safety_education" AS "arc_programs_health_safety_education", "a"."arc_programs_support_for_armed_forces" AS "arc_programs_support_for_armed_forces", "a"."arc_programs_blood_services" AS "arc_programs_blood_services", "a"."arc_programs_domestic_disaster_relief" AS "arc_programs_domestic_disaster_relief", "a"."arc_programs_international_relief" AS "arc_programs_international_relief", "a"."arc_programs_important_to_provide_arc_services_in_future" AS "arc_programs_important_to_provide_arc_services_in_future", "a"."means_of_support_check_credit_card" AS "means_of_support_check_credit_card", "a"."means_of_support_volunteering" AS "means_of_support_volunteering", "a"."means_of_support_gift_in_your_will" AS "means_of_support_gift_in_your_will", "a"."means_of_support_gift_in_your_will_honoring_a_loved_one" AS "means_of_support_gift_in_your_will_honoring_a_loved_one", "a"."means_of_support_beneficiary_designation" AS "means_of_support_beneficiary_designation", "a"."means_of_support_gift_ira_chrtbl_dstrbtn" AS "means_of_support_gift_ira_chrtbl_dstrbtn", "a"."means_of_support_blood_donation" AS "means_of_support_blood_donation", "a"."means_of_support_gifts_that_pay_you_income_for_life" AS "means_of_support_gifts_that_pay_you_income_for_life", "a"."means_of_support_gifts_of_other_assets_stock_real_estate_bank_acct" AS "means_of_support_gifts_of_other_assets_stock_real_estate_bank_acct", "a"."marital_status" AS "marital_status", "a"."chldrn" AS "chldrn", "a"."grndchldrn" AS "grndchldrn", "a"."arc_story" AS "arc_story", "a"."age" AS "age", "a"."cds_image_id" AS "cds_image_id", "a"."gift_typ" AS "gift_typ", "a"."gift_created_dt_src" AS "gift_created_dt_src", "a"."gift_created_dt" AS "gift_created_dt", "a"."dcmnt_created_dt_src" AS "dcmnt_created_dt_src", "a"."dcmnt_created_dt" AS "dcmnt_created_dt", "a"."est_gift_value_amt" AS "est_gift_value_amt", "a"."gift_value_typ" AS "gift_value_typ", "a"."plan_typ" AS "plan_typ", "a"."contigent_lvl" AS "contigent_lvl", "a"."message" AS "message", "a"."don_ext_id" AS "don_ext_id", "a"."frwl_gift_id" AS "frwl_gift_id", "a"."asset_type" AS "asset_type", "a"."fincl_inst" AS "fincl_inst", "a"."prfrd_nm" AS "prfrd_nm", "a"."chng_made_dt_src" AS "chng_made_dt_src", "a"."chng_made_dt" AS "chng_made_dt", "a"."old_gift_value_amt" AS "old_gift_value_amt", "a"."new_gift_value_amt" AS "new_gift_value_amt", "a"."jnt_gft_ind" AS "jnt_gft_ind", "a"."addtnl_nm" AS "addtnl_nm", "a"."anmty_ind" AS "anmty_ind", "a"."gft_vhcl_dsc" AS "gft_vhcl_dsc", "a"."dsgntn_dsc" AS "dsgntn_dsc", "a"."gft_cmnts" AS "gft_cmnts", "a"."mds_pg_response_typ" AS "mds_pg_response_typ", "a"."hist_seqnum" AS "hist_seqnum", "a"."history_record_id" AS "history_record_id", "a"."pgc_response_id" AS "pgc_response_id", "a"."mds_unq_id" AS "mds_unq_id", "a"."rcrdg_file_nm" AS "rcrdg_file_nm", "a"."curr_prcsd_file_nm" AS "curr_prcsd_file_nm", "a"."last_match_proc_dt" AS "last_match_proc_dt", "a"."stuart_list_proc_dt" AS "stuart_list_proc_dt", "a"."dw_trans_ts" AS "dw_trans_ts", CASE WHEN "c"."email_addr" IS NOT NULL THEN CAST('L' AS BPCHAR) ELSE "a"."row_stat_cd" END AS "row_stat_cd", "a"."appl_src_cd" AS "appl_src_cd", "a"."load_id" AS "load_id" FROM ("mktg_ops_tbls"."bzfc_pg_response_log" AS "a" LEFT JOIN "mktg_ops_vws"."bzfc_pg_response_log_ref" AS "b" ON "a"."history_record_id" = "b"."history_record_id") LEFT JOIN "mktg_ops_vws"."bz_pg_response_log_exclusion" AS "c" ON "a"."clnsd_email_addr" = "c"."email_addr" WHERE "a"."appl_src_cd" = CAST('ADBE' AS TEXT) QUALIFY ROW_NUMBER() OVER (PARTITION BY "a"."history_record_id" ORDER BY "a"."dw_trans_ts" ASC NULLS LAST) = CAST(1 AS INT4)) UNION ALL (SELECT "b_1"."pg_response_log_key" AS "pg_response_log_key", "a_1"."clnsd_first_nm" AS "clnsd_first_nm", "a_1"."clnsd_last_nm" AS "clnsd_last_nm", "a_1"."clnsd_email_addr" AS "clnsd_email_addr", "a_1"."derived_campaign" AS "derived_campaign", "a_1"."first_response_dt" AS "first_response_dt", "a_1"."response_group_dsc" AS "response_group_dsc", "a_1"."response_cnt" AS "response_cnt", "a_1"."first_response_ts" AS "first_response_ts", "a_1"."match_lob_src" AS "match_lob_src", "a_1"."match_typ" AS "match_typ", "a_1"."cds_batch_number" AS "cds_batch_number", "a_1"."cds_sequence_number" AS "cds_sequence_number", "a_1"."response_ts_src" AS "response_ts_src", "a_1"."response_ts" AS "response_ts", "a_1"."response_dt" AS "response_dt", "a_1"."site_url" AS "site_url", CAST(CASE WHEN (pg_catalog.POSITION(BTRIM("a_1"."site_url"), CAST('source=' AS TEXT)) = CAST(0 AS INT4)) THEN CAST(NULL AS TEXT) ELSE pg_catalog.SUBSTRING(pg_catalog.SUBSTRING(BTRIM("a_1"."site_url"), pg_catalog.POSITION(BTRIM("a_1"."site_url"), CAST('source=' AS TEXT))), CAST(8 AS INT4), CASE WHEN (pg_catalog.POSITION(pg_catalog.SUBSTRING(BTRIM("a_1"."site_url"), pg_catalog.POSITION(BTRIM("a_1"."site_url"), CAST('source=' AS TEXT))), CAST('&' AS TEXT)) = CAST(0 AS INT4)) THEN CAST(10 AS INT4) ELSE (pg_catalog.POSITION(pg_catalog.SUBSTRING(BTRIM("a_1"."site_url"), pg_catalog.POSITION(BTRIM("a_1"."site_url"), CAST('source=' AS TEXT))), CAST('&' AS TEXT)) - CAST(8 AS INT4)) END) END AS VARCHAR) AS "site_src", "a_1"."lander_type" AS "lander_type", "a_1"."nk_ecode" AS "nk_ecode", "a_1"."src_cd_src" AS "src_cd_src", CASE WHEN (("a_1"."scr_cd" = CAST('APP20091M000' AS TEXT)) AND ("a_1"."response_dt" >= CAST('2021-09-07' AS DATE))) THEN CAST('APP21091M000' AS VARCHAR) WHEN (("a_1"."scr_cd" = CAST('APP2308AE000' AS TEXT)) AND ("a_1"."response_dt" >= CAST('2024-07-31' AS DATE))) THEN CAST('APP2408AE000' AS VARCHAR) WHEN (("a_1"."scr_cd" = CAST('APP18092M000' AS TEXT)) AND ("a_1"."response_dt" >= CAST('2024-07-31' AS DATE))) THEN CAST('APP24082M000' AS VARCHAR) WHEN (("a_1"."scr_cd" = CAST('APP23082E000' AS TEXT)) AND ("a_1"."response_dt" >= CAST('2024-07-31' AS DATE))) THEN CAST('APP24082E000' AS VARCHAR) ELSE "a_1"."scr_cd" END AS "scr_cd", "a_1"."cnst_mstr_id_src" AS "cnst_mstr_id_src", "a_1"."cnst_mstr_id" AS "cnst_mstr_id", "a_1"."orig_cnst_mstr_id" AS "orig_cnst_mstr_id", "a_1"."ttl" AS "ttl", "a_1"."first_nm" AS "first_nm", "a_1"."middle_nm" AS "middle_nm", "a_1"."last_nm" AS "last_nm", "a_1"."sfx" AS "sfx", "a_1"."prf_ttl" AS "prf_ttl", "a_1"."cmpny_nm" AS "cmpny_nm", "a_1"."birth_dt_src" AS "birth_dt_src", CASE WHEN ((pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_1"."birth_dt") >= CAST(0 AS INT4)) AND (pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_1"."birth_dt") <= CAST(99 AS INT4))) THEN DATE_ADD(CAST('month' AS TEXT), CAST(22800 AS INT4), "a_1"."birth_dt") ELSE "a_1"."birth_dt" END AS "birth_dt", "a_1"."spouse_birth_dt_src" AS "spouse_birth_dt_src", CASE WHEN ((pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_1"."spouse_birth_dt") >= CAST(0 AS INT4)) AND (pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_1"."spouse_birth_dt") <= CAST(99 AS INT4))) THEN DATE_ADD(CAST('month' AS TEXT), CAST(22800 AS INT4), "a_1"."spouse_birth_dt") ELSE "a_1"."spouse_birth_dt" END AS "spouse_birth_dt", "a_1"."addr_ln1" AS "addr_ln1", "a_1"."addr_ln2" AS "addr_ln2", "a_1"."addr_ln3" AS "addr_ln3", "a_1"."city" AS "city", "a_1"."state" AS "state", "a_1"."zip_cd" AS "zip_cd", "a_1"."phone_num" AS "phone_num", "a_1"."phone_mobile_ind" AS "phone_mobile_ind", "a_1"."phone_home_ind" AS "phone_home_ind", "a_1"."email_addr" AS "email_addr", "a_1"."cntct_prfrnc" AS "cntct_prfrnc", COALESCE("a_1"."cntct_prfrnc_phone_ind", CAST(0 AS INT4)) AS "cntct_prfrnc_phone_ind", COALESCE("a_1"."cntct_prfrnc_text_ind", CAST(0 AS INT4)) AS "cntct_prfrnc_text_ind", COALESCE("a_1"."cntct_prfrnc_email_ind", CAST(0 AS INT4)) AS "cntct_prfrnc_email_ind", "a_1"."cdrp_pg_info_request_pg_information" AS "cdrp_pg_info_request_pg_information", "a_1"."cdrp_pg_confirm_arc_in_will" AS "cdrp_pg_confirm_arc_in_will", "a_1"."cga_age_payments_begin" AS "cga_age_payments_begin", "a_1"."cga_5000" AS "cga_5000", "a_1"."cga_10000" AS "cga_10000", "a_1"."cga_50000" AS "cga_50000", "a_1"."cga_100000" AS "cga_100000", "a_1"."cga_other" AS "cga_other", "a_1"."cga_fdbk" AS "cga_fdbk", "a_1"."wg_rqst" AS "wg_rqst", "a_1"."wg_arc_in_will" AS "wg_arc_in_will", "a_1"."wg_intend_arc_in_will" AS "wg_intend_arc_in_will", "a_1"."wg_consider_arc_in_will" AS "wg_consider_arc_in_will", "a_1"."wg_fdbk" AS "wg_fdbk", "a_1"."interest_in_life_income_gift_w_stock" AS "interest_in_life_income_gift_w_stock", "a_1"."interest_in_life_income_gift_w_real_estate" AS "interest_in_life_income_gift_w_real_estate", "a_1"."interest_in_life_income_gift_w_ira" AS "interest_in_life_income_gift_w_ira", "a_1"."interest_in_gift_in_will" AS "interest_in_gift_in_will", "a_1"."interest_in_gift_outside_will" AS "interest_in_gift_outside_will", "a_1"."interest_in_life_income_gifts" AS "interest_in_life_income_gifts", "a_1"."interest_in_ira_qcd_gifts" AS "interest_in_ira_qcd_gifts", "a_1"."consider_charity_in_will" AS "consider_charity_in_will", "a_1"."email_opt_in" AS "email_opt_in", "a_1"."giving_reason_arc_was_there_for_me" AS "giving_reason_arc_was_there_for_me", "a_1"."giving_reason_provide_general_support" AS "giving_reason_provide_general_support", "a_1"."giving_reason_respond_to_local_or_national_disasters_or_emergencies" AS "giving_reason_respond_to_local_or_national_disasters_or_emergencies", "a_1"."giving_reason_tax_purposes" AS "giving_reason_tax_purposes", "a_1"."giving_reason_believe_in_arc_mission" AS "giving_reason_believe_in_arc_mission", "a_1"."giving_reason_frnd_fmly_mbr_suprtr" AS "giving_reason_frnd_fmly_mbr_suprtr", "a_1"."influential_person_in_your_life" AS "influential_person_in_your_life", "a_1"."has_the_arc_brought_hope_and_help_to_your_family_or_community" AS "has_the_arc_brought_hope_and_help_to_your_family_or_community", "a_1"."arc_programs_health_safety_education" AS "arc_programs_health_safety_education", "a_1"."arc_programs_support_for_armed_forces" AS "arc_programs_support_for_armed_forces", "a_1"."arc_programs_blood_services" AS "arc_programs_blood_services", "a_1"."arc_programs_domestic_disaster_relief" AS "arc_programs_domestic_disaster_relief", "a_1"."arc_programs_international_relief" AS "arc_programs_international_relief", "a_1"."arc_programs_important_to_provide_arc_services_in_future" AS "arc_programs_important_to_provide_arc_services_in_future", "a_1"."means_of_support_check_credit_card" AS "means_of_support_check_credit_card", "a_1"."means_of_support_volunteering" AS "means_of_support_volunteering", "a_1"."means_of_support_gift_in_your_will" AS "means_of_support_gift_in_your_will", "a_1"."means_of_support_gift_in_your_will_honoring_a_loved_one" AS "means_of_support_gift_in_your_will_honoring_a_loved_one", "a_1"."means_of_support_beneficiary_designation" AS "means_of_support_beneficiary_designation", "a_1"."means_of_support_gift_ira_chrtbl_dstrbtn" AS "means_of_support_gift_ira_chrtbl_dstrbtn", "a_1"."means_of_support_blood_donation" AS "means_of_support_blood_donation", "a_1"."means_of_support_gifts_that_pay_you_income_for_life" AS "means_of_support_gifts_that_pay_you_income_for_life", "a_1"."means_of_support_gifts_of_other_assets_stock_real_estate_bank_acct" AS "means_of_support_gifts_of_other_assets_stock_real_estate_bank_acct", "a_1"."marital_status" AS "marital_status", "a_1"."chldrn" AS "chldrn", "a_1"."grndchldrn" AS "grndchldrn", "a_1"."arc_story" AS "arc_story", "a_1"."age" AS "age", "a_1"."cds_image_id" AS "cds_image_id", "a_1"."gift_typ" AS "gift_typ", "a_1"."gift_created_dt_src" AS "gift_created_dt_src", "a_1"."gift_created_dt" AS "gift_created_dt", "a_1"."dcmnt_created_dt_src" AS "dcmnt_created_dt_src", "a_1"."dcmnt_created_dt" AS "dcmnt_created_dt", "a_1"."est_gift_value_amt" AS "est_gift_value_amt", "a_1"."gift_value_typ" AS "gift_value_typ", "a_1"."plan_typ" AS "plan_typ", "a_1"."contigent_lvl" AS "contigent_lvl", "a_1"."message" AS "message", "a_1"."don_ext_id" AS "don_ext_id", "a_1"."frwl_gift_id" AS "frwl_gift_id", "a_1"."asset_type" AS "asset_type", "a_1"."fincl_inst" AS "fincl_inst", "a_1"."prfrd_nm" AS "prfrd_nm", "a_1"."chng_made_dt_src" AS "chng_made_dt_src", "a_1"."chng_made_dt" AS "chng_made_dt", "a_1"."old_gift_value_amt" AS "old_gift_value_amt", "a_1"."new_gift_value_amt" AS "new_gift_value_amt", "a_1"."jnt_gft_ind" AS "jnt_gft_ind", "a_1"."addtnl_nm" AS "addtnl_nm", "a_1"."anmty_ind" AS "anmty_ind", "a_1"."gft_vhcl_dsc" AS "gft_vhcl_dsc", "a_1"."dsgntn_dsc" AS "dsgntn_dsc", "a_1"."gft_cmnts" AS "gft_cmnts", "a_1"."mds_pg_response_typ" AS "mds_pg_response_typ", "a_1"."hist_seqnum" AS "hist_seqnum", "a_1"."history_record_id" AS "history_record_id", "a_1"."pgc_response_id" AS "pgc_response_id", "a_1"."mds_unq_id" AS "mds_unq_id", "a_1"."rcrdg_file_nm" AS "rcrdg_file_nm", "a_1"."curr_prcsd_file_nm" AS "curr_prcsd_file_nm", "a_1"."last_match_proc_dt" AS "last_match_proc_dt", "a_1"."stuart_list_proc_dt" AS "stuart_list_proc_dt", "a_1"."dw_trans_ts" AS "dw_trans_ts", CASE WHEN "c_1"."email_addr" IS NOT NULL THEN CAST('L' AS BPCHAR) ELSE "a_1"."row_stat_cd" END AS "row_stat_cd", "a_1"."appl_src_cd" AS "appl_src_cd", "a_1"."load_id" AS "load_id" FROM ("mktg_ops_tbls"."bzfc_pg_response_log" AS "a_1" LEFT JOIN "mktg_ops_vws"."bzfc_pg_response_log_ref" AS "b_1" ON (("a_1"."cds_image_id" = "b_1"."cds_image_id") OR ("a_1"."cds_image_id" IS NULL AND "b_1"."cds_image_id" IS NULL)) AND ("a_1"."appl_src_cd" = "b_1"."appl_src_cd")) LEFT JOIN "mktg_ops_vws"."bz_pg_response_log_exclusion" AS "c_1" ON "a_1"."clnsd_email_addr" = "c_1"."email_addr" WHERE (("a_1"."appl_src_cd" = CAST('CDS' AS TEXT)) OR ("a_1"."appl_src_cd" = CAST('HIST' AS TEXT))) AND "a_1"."cds_image_id" IS NOT NULL QUALIFY ROW_NUMBER() OVER (PARTITION BY "a_1"."cds_image_id" ORDER BY "a_1"."dw_trans_ts" ASC NULLS LAST) = CAST(1 AS INT4))) UNION ALL (SELECT "b_2"."pg_response_log_key" AS "pg_response_log_key", "a_2"."clnsd_first_nm" AS "clnsd_first_nm", "a_2"."clnsd_last_nm" AS "clnsd_last_nm", "a_2"."clnsd_email_addr" AS "clnsd_email_addr", "a_2"."derived_campaign" AS "derived_campaign", "a_2"."first_response_dt" AS "first_response_dt", "a_2"."response_group_dsc" AS "response_group_dsc", "a_2"."response_cnt" AS "response_cnt", "a_2"."first_response_ts" AS "first_response_ts", "a_2"."match_lob_src" AS "match_lob_src", "a_2"."match_typ" AS "match_typ", "a_2"."cds_batch_number" AS "cds_batch_number", "a_2"."cds_sequence_number" AS "cds_sequence_number", "a_2"."response_ts_src" AS "response_ts_src", "a_2"."response_ts" AS "response_ts", "a_2"."response_dt" AS "response_dt", "a_2"."site_url" AS "site_url", CAST(CASE WHEN (pg_catalog.POSITION(BTRIM("a_2"."site_url"), CAST('source=' AS TEXT)) = CAST(0 AS INT4)) THEN CAST(NULL AS TEXT) ELSE pg_catalog.SUBSTRING(pg_catalog.SUBSTRING(BTRIM("a_2"."site_url"), pg_catalog.POSITION(BTRIM("a_2"."site_url"), CAST('source=' AS TEXT))), CAST(8 AS INT4), CASE WHEN (pg_catalog.POSITION(pg_catalog.SUBSTRING(BTRIM("a_2"."site_url"), pg_catalog.POSITION(BTRIM("a_2"."site_url"), CAST('source=' AS TEXT))), CAST('&' AS TEXT)) = CAST(0 AS INT4)) THEN CAST(10 AS INT4) ELSE (pg_catalog.POSITION(pg_catalog.SUBSTRING(BTRIM("a_2"."site_url"), pg_catalog.POSITION(BTRIM("a_2"."site_url"), CAST('source=' AS TEXT))), CAST('&' AS TEXT)) - CAST(8 AS INT4)) END) END AS VARCHAR) AS "site_src", "a_2"."lander_type" AS "lander_type", "a_2"."nk_ecode" AS "nk_ecode", "a_2"."src_cd_src" AS "src_cd_src", CASE WHEN (("a_2"."scr_cd" = CAST('APP20091M000' AS TEXT)) AND ("a_2"."response_dt" >= CAST('2021-09-07' AS DATE))) THEN CAST('APP21091M000' AS VARCHAR) WHEN (("a_2"."scr_cd" = CAST('APP2308AE000' AS TEXT)) AND ("a_2"."response_dt" >= CAST('2024-07-31' AS DATE))) THEN CAST('APP2408AE000' AS VARCHAR) WHEN (("a_2"."scr_cd" = CAST('APP18092M000' AS TEXT)) AND ("a_2"."response_dt" >= CAST('2024-07-31' AS DATE))) THEN CAST('APP24082M000' AS VARCHAR) WHEN (("a_2"."scr_cd" = CAST('APP23082E000' AS TEXT)) AND ("a_2"."response_dt" >= CAST('2024-07-31' AS DATE))) THEN CAST('APP24082E000' AS VARCHAR) ELSE "a_2"."scr_cd" END AS "scr_cd", "a_2"."cnst_mstr_id_src" AS "cnst_mstr_id_src", "a_2"."cnst_mstr_id" AS "cnst_mstr_id", "a_2"."orig_cnst_mstr_id" AS "orig_cnst_mstr_id", "a_2"."ttl" AS "ttl", "a_2"."first_nm" AS "first_nm", "a_2"."middle_nm" AS "middle_nm", "a_2"."last_nm" AS "last_nm", "a_2"."sfx" AS "sfx", "a_2"."prf_ttl" AS "prf_ttl", "a_2"."cmpny_nm" AS "cmpny_nm", "a_2"."birth_dt_src" AS "birth_dt_src", CASE WHEN ((pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_2"."birth_dt") >= CAST(0 AS INT4)) AND (pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_2"."birth_dt") <= CAST(99 AS INT4))) THEN DATE_ADD(CAST('month' AS TEXT), CAST(22800 AS INT4), "a_2"."birth_dt") ELSE "a_2"."birth_dt" END AS "birth_dt", "a_2"."spouse_birth_dt_src" AS "spouse_birth_dt_src", CASE WHEN ((pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_2"."spouse_birth_dt") >= CAST(0 AS INT4)) AND (pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_2"."spouse_birth_dt") <= CAST(99 AS INT4))) THEN DATE_ADD(CAST('month' AS TEXT), CAST(22800 AS INT4), "a_2"."spouse_birth_dt") ELSE "a_2"."spouse_birth_dt" END AS "spouse_birth_dt", "a_2"."addr_ln1" AS "addr_ln1", "a_2"."addr_ln2" AS "addr_ln2", "a_2"."addr_ln3" AS "addr_ln3", "a_2"."city" AS "city", "a_2"."state" AS "state", "a_2"."zip_cd" AS "zip_cd", "a_2"."phone_num" AS "phone_num", "a_2"."phone_mobile_ind" AS "phone_mobile_ind", "a_2"."phone_home_ind" AS "phone_home_ind", "a_2"."email_addr" AS "email_addr", "a_2"."cntct_prfrnc" AS "cntct_prfrnc", COALESCE("a_2"."cntct_prfrnc_phone_ind", CAST(0 AS INT4)) AS "cntct_prfrnc_phone_ind", COALESCE("a_2"."cntct_prfrnc_text_ind", CAST(0 AS INT4)) AS "cntct_prfrnc_text_ind", COALESCE("a_2"."cntct_prfrnc_email_ind", CAST(0 AS INT4)) AS "cntct_prfrnc_email_ind", "a_2"."cdrp_pg_info_request_pg_information" AS "cdrp_pg_info_request_pg_information", "a_2"."cdrp_pg_confirm_arc_in_will" AS "cdrp_pg_confirm_arc_in_will", "a_2"."cga_age_payments_begin" AS "cga_age_payments_begin", "a_2"."cga_5000" AS "cga_5000", "a_2"."cga_10000" AS "cga_10000", "a_2"."cga_50000" AS "cga_50000", "a_2"."cga_100000" AS "cga_100000", "a_2"."cga_other" AS "cga_other", "a_2"."cga_fdbk" AS "cga_fdbk", "a_2"."wg_rqst" AS "wg_rqst", "a_2"."wg_arc_in_will" AS "wg_arc_in_will", "a_2"."wg_intend_arc_in_will" AS "wg_intend_arc_in_will", "a_2"."wg_consider_arc_in_will" AS "wg_consider_arc_in_will", "a_2"."wg_fdbk" AS "wg_fdbk", "a_2"."interest_in_life_income_gift_w_stock" AS "interest_in_life_income_gift_w_stock", "a_2"."interest_in_life_income_gift_w_real_estate" AS "interest_in_life_income_gift_w_real_estate", "a_2"."interest_in_life_income_gift_w_ira" AS "interest_in_life_income_gift_w_ira", "a_2"."interest_in_gift_in_will" AS "interest_in_gift_in_will", "a_2"."interest_in_gift_outside_will" AS "interest_in_gift_outside_will", "a_2"."interest_in_life_income_gifts" AS "interest_in_life_income_gifts", "a_2"."interest_in_ira_qcd_gifts" AS "interest_in_ira_qcd_gifts", "a_2"."consider_charity_in_will" AS "consider_charity_in_will", "a_2"."email_opt_in" AS "email_opt_in", "a_2"."giving_reason_arc_was_there_for_me" AS "giving_reason_arc_was_there_for_me", "a_2"."giving_reason_provide_general_support" AS "giving_reason_provide_general_support", "a_2"."giving_reason_respond_to_local_or_national_disasters_or_emergencies" AS "giving_reason_respond_to_local_or_national_disasters_or_emergencies", "a_2"."giving_reason_tax_purposes" AS "giving_reason_tax_purposes", "a_2"."giving_reason_believe_in_arc_mission" AS "giving_reason_believe_in_arc_mission", "a_2"."giving_reason_frnd_fmly_mbr_suprtr" AS "giving_reason_frnd_fmly_mbr_suprtr", "a_2"."influential_person_in_your_life" AS "influential_person_in_your_life", "a_2"."has_the_arc_brought_hope_and_help_to_your_family_or_community" AS "has_the_arc_brought_hope_and_help_to_your_family_or_community", "a_2"."arc_programs_health_safety_education" AS "arc_programs_health_safety_education", "a_2"."arc_programs_support_for_armed_forces" AS "arc_programs_support_for_armed_forces", "a_2"."arc_programs_blood_services" AS "arc_programs_blood_services", "a_2"."arc_programs_domestic_disaster_relief" AS "arc_programs_domestic_disaster_relief", "a_2"."arc_programs_international_relief" AS "arc_programs_international_relief", "a_2"."arc_programs_important_to_provide_arc_services_in_future" AS "arc_programs_important_to_provide_arc_services_in_future", "a_2"."means_of_support_check_credit_card" AS "means_of_support_check_credit_card", "a_2"."means_of_support_volunteering" AS "means_of_support_volunteering", "a_2"."means_of_support_gift_in_your_will" AS "means_of_support_gift_in_your_will", "a_2"."means_of_support_gift_in_your_will_honoring_a_loved_one" AS "means_of_support_gift_in_your_will_honoring_a_loved_one", "a_2"."means_of_support_beneficiary_designation" AS "means_of_support_beneficiary_designation", "a_2"."means_of_support_gift_ira_chrtbl_dstrbtn" AS "means_of_support_gift_ira_chrtbl_dstrbtn", "a_2"."means_of_support_blood_donation" AS "means_of_support_blood_donation", "a_2"."means_of_support_gifts_that_pay_you_income_for_life" AS "means_of_support_gifts_that_pay_you_income_for_life", "a_2"."means_of_support_gifts_of_other_assets_stock_real_estate_bank_acct" AS "means_of_support_gifts_of_other_assets_stock_real_estate_bank_acct", "a_2"."marital_status" AS "marital_status", "a_2"."chldrn" AS "chldrn", "a_2"."grndchldrn" AS "grndchldrn", "a_2"."arc_story" AS "arc_story", "a_2"."age" AS "age", "a_2"."cds_image_id" AS "cds_image_id", "a_2"."gift_typ" AS "gift_typ", "a_2"."gift_created_dt_src" AS "gift_created_dt_src", "a_2"."gift_created_dt" AS "gift_created_dt", "a_2"."dcmnt_created_dt_src" AS "dcmnt_created_dt_src", "a_2"."dcmnt_created_dt" AS "dcmnt_created_dt", "a_2"."est_gift_value_amt" AS "est_gift_value_amt", "a_2"."gift_value_typ" AS "gift_value_typ", "a_2"."plan_typ" AS "plan_typ", "a_2"."contigent_lvl" AS "contigent_lvl", "a_2"."message" AS "message", "a_2"."don_ext_id" AS "don_ext_id", "a_2"."frwl_gift_id" AS "frwl_gift_id", "a_2"."asset_type" AS "asset_type", "a_2"."fincl_inst" AS "fincl_inst", "a_2"."prfrd_nm" AS "prfrd_nm", "a_2"."chng_made_dt_src" AS "chng_made_dt_src", "a_2"."chng_made_dt" AS "chng_made_dt", "a_2"."old_gift_value_amt" AS "old_gift_value_amt", "a_2"."new_gift_value_amt" AS "new_gift_value_amt", "a_2"."jnt_gft_ind" AS "jnt_gft_ind", "a_2"."addtnl_nm" AS "addtnl_nm", "a_2"."anmty_ind" AS "anmty_ind", "a_2"."gft_vhcl_dsc" AS "gft_vhcl_dsc", "a_2"."dsgntn_dsc" AS "dsgntn_dsc", "a_2"."gft_cmnts" AS "gft_cmnts", "a_2"."mds_pg_response_typ" AS "mds_pg_response_typ", "a_2"."hist_seqnum" AS "hist_seqnum", "a_2"."history_record_id" AS "history_record_id", "a_2"."pgc_response_id" AS "pgc_response_id", "a_2"."mds_unq_id" AS "mds_unq_id", "a_2"."rcrdg_file_nm" AS "rcrdg_file_nm", "a_2"."curr_prcsd_file_nm" AS "curr_prcsd_file_nm", "a_2"."last_match_proc_dt" AS "last_match_proc_dt", "a_2"."stuart_list_proc_dt" AS "stuart_list_proc_dt", "a_2"."dw_trans_ts" AS "dw_trans_ts", CASE WHEN "c_2"."email_addr" IS NOT NULL THEN CAST('L' AS BPCHAR) ELSE "a_2"."row_stat_cd" END AS "row_stat_cd", "a_2"."appl_src_cd" AS "appl_src_cd", "a_2"."load_id" AS "load_id" FROM ("mktg_ops_tbls"."bzfc_pg_response_log" AS "a_2" LEFT JOIN "mktg_ops_vws"."bzfc_pg_response_log_ref" AS "b_2" ON "a_2"."frwl_gift_id" = "b_2"."frwl_gift_id") LEFT JOIN "mktg_ops_vws"."bz_pg_response_log_exclusion" AS "c_2" ON "a_2"."clnsd_email_addr" = "c_2"."email_addr" WHERE "a_2"."appl_src_cd" = CAST('FRWL' AS TEXT) QUALIFY ROW_NUMBER() OVER (PARTITION BY "a_2"."frwl_gift_id" ORDER BY "a_2"."dw_trans_ts" ASC NULLS LAST) = CAST(1 AS INT4))) UNION ALL (SELECT "b_3"."pg_response_log_key" AS "pg_response_log_key", "a_3"."clnsd_first_nm" AS "clnsd_first_nm", "a_3"."clnsd_last_nm" AS "clnsd_last_nm", "a_3"."clnsd_email_addr" AS "clnsd_email_addr", "a_3"."derived_campaign" AS "derived_campaign", "a_3"."first_response_dt" AS "first_response_dt", "a_3"."response_group_dsc" AS "response_group_dsc", "a_3"."response_cnt" AS "response_cnt", "a_3"."first_response_ts" AS "first_response_ts", "a_3"."match_lob_src" AS "match_lob_src", "a_3"."match_typ" AS "match_typ", "a_3"."cds_batch_number" AS "cds_batch_number", "a_3"."cds_sequence_number" AS "cds_sequence_number", "a_3"."response_ts_src" AS "response_ts_src", "a_3"."response_ts" AS "response_ts", "a_3"."response_dt" AS "response_dt", "a_3"."site_url" AS "site_url", CAST(CASE WHEN (pg_catalog.POSITION(BTRIM("a_3"."site_url"), CAST('source=' AS TEXT)) = CAST(0 AS INT4)) THEN CAST(NULL AS TEXT) ELSE pg_catalog.SUBSTRING(pg_catalog.SUBSTRING(BTRIM("a_3"."site_url"), pg_catalog.POSITION(BTRIM("a_3"."site_url"), CAST('source=' AS TEXT))), CAST(8 AS INT4), CASE WHEN (pg_catalog.POSITION(pg_catalog.SUBSTRING(BTRIM("a_3"."site_url"), pg_catalog.POSITION(BTRIM("a_3"."site_url"), CAST('source=' AS TEXT))), CAST('&' AS TEXT)) = CAST(0 AS INT4)) THEN CAST(10 AS INT4) ELSE (pg_catalog.POSITION(pg_catalog.SUBSTRING(BTRIM("a_3"."site_url"), pg_catalog.POSITION(BTRIM("a_3"."site_url"), CAST('source=' AS TEXT))), CAST('&' AS TEXT)) - CAST(8 AS INT4)) END) END AS VARCHAR) AS "site_src", "a_3"."lander_type" AS "lander_type", "a_3"."nk_ecode" AS "nk_ecode", "a_3"."src_cd_src" AS "src_cd_src", CASE WHEN (("a_3"."scr_cd" = CAST('APP20091M000' AS TEXT)) AND ("a_3"."response_dt" >= TO_DATE(CAST('09/07/2021' AS TEXT), CAST('MM/DD/YYYY' AS TEXT)))) THEN CAST('APP21091M000' AS VARCHAR) WHEN (("a_3"."scr_cd" = CAST('APP2308AE000' AS TEXT)) AND ("a_3"."response_dt" >= TO_DATE(CAST('07/31/2024' AS TEXT), CAST('MM/DD/YYYY' AS TEXT)))) THEN CAST('APP2408AE000' AS VARCHAR) WHEN (("a_3"."scr_cd" = CAST('APP18092M000' AS TEXT)) AND ("a_3"."response_dt" >= TO_DATE(CAST('07/31/2024' AS TEXT), CAST('MM/DD/YYYY' AS TEXT)))) THEN CAST('APP24082M000' AS VARCHAR) WHEN (("a_3"."scr_cd" = CAST('APP23082E000' AS TEXT)) AND ("a_3"."response_dt" >= TO_DATE(CAST('07/31/2024' AS TEXT), CAST('MM/DD/YYYY' AS TEXT)))) THEN CAST('APP24082E000' AS VARCHAR) ELSE "a_3"."scr_cd" END AS "scr_cd", "a_3"."cnst_mstr_id_src" AS "cnst_mstr_id_src", "a_3"."cnst_mstr_id" AS "cnst_mstr_id", "a_3"."orig_cnst_mstr_id" AS "orig_cnst_mstr_id", "a_3"."ttl" AS "ttl", "a_3"."first_nm" AS "first_nm", "a_3"."middle_nm" AS "middle_nm", "a_3"."last_nm" AS "last_nm", "a_3"."sfx" AS "sfx", "a_3"."prf_ttl" AS "prf_ttl", "a_3"."cmpny_nm" AS "cmpny_nm", "a_3"."birth_dt_src" AS "birth_dt_src", CASE WHEN ((pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_3"."birth_dt") >= CAST(0 AS INT4)) AND (pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_3"."birth_dt") <= CAST(99 AS INT4))) THEN ADD_MONTHS("a_3"."birth_dt", CAST(22800 AS INT4)) ELSE "a_3"."birth_dt" END AS "birth_dt", "a_3"."spouse_birth_dt_src" AS "spouse_birth_dt_src", CASE WHEN ((pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_3"."spouse_birth_dt") >= CAST(0 AS INT4)) AND (pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_3"."spouse_birth_dt") <= CAST(99 AS INT4))) THEN ADD_MONTHS("a_3"."spouse_birth_dt", CAST(22800 AS INT4)) ELSE "a_3"."spouse_birth_dt" END AS "spouse_birth_dt", "a_3"."addr_ln1" AS "addr_ln1", "a_3"."addr_ln2" AS "addr_ln2", "a_3"."addr_ln3" AS "addr_ln3", "a_3"."city" AS "city", "a_3"."state" AS "state", "a_3"."zip_cd" AS "zip_cd", "a_3"."phone_num" AS "phone_num", "a_3"."phone_mobile_ind" AS "phone_mobile_ind", "a_3"."phone_home_ind" AS "phone_home_ind", "a_3"."email_addr" AS "email_addr", "a_3"."cntct_prfrnc" AS "cntct_prfrnc", COALESCE("a_3"."cntct_prfrnc_phone_ind", CAST(0 AS INT4)) AS "cntct_prfrnc_phone_ind", COALESCE("a_3"."cntct_prfrnc_text_ind", CAST(0 AS INT4)) AS "cntct_prfrnc_text_ind", COALESCE("a_3"."cntct_prfrnc_email_ind", CAST(0 AS INT4)) AS "cntct_prfrnc_email_ind", "a_3"."cdrp_pg_info_request_pg_information" AS "cdrp_pg_info_request_pg_information", "a_3"."cdrp_pg_confirm_arc_in_will" AS "cdrp_pg_confirm_arc_in_will", "a_3"."cga_age_payments_begin" AS "cga_age_payments_begin", "a_3"."cga_5000" AS "cga_5000", "a_3"."cga_10000" AS "cga_10000", "a_3"."cga_50000" AS "cga_50000", "a_3"."cga_100000" AS "cga_100000", "a_3"."cga_other" AS "cga_other", "a_3"."cga_fdbk" AS "cga_fdbk", "a_3"."wg_rqst" AS "wg_rqst", "a_3"."wg_arc_in_will" AS "wg_arc_in_will", "a_3"."wg_intend_arc_in_will" AS "wg_intend_arc_in_will", "a_3"."wg_consider_arc_in_will" AS "wg_consider_arc_in_will", "a_3"."wg_fdbk" AS "wg_fdbk", "a_3"."interest_in_life_income_gift_w_stock" AS "interest_in_life_income_gift_w_stock", "a_3"."interest_in_life_income_gift_w_real_estate" AS "interest_in_life_income_gift_w_real_estate", "a_3"."interest_in_life_income_gift_w_ira" AS "interest_in_life_income_gift_w_ira", "a_3"."interest_in_gift_in_will" AS "interest_in_gift_in_will", "a_3"."interest_in_gift_outside_will" AS "interest_in_gift_outside_will", "a_3"."interest_in_life_income_gifts" AS "interest_in_life_income_gifts", "a_3"."interest_in_ira_qcd_gifts" AS "interest_in_ira_qcd_gifts", "a_3"."consider_charity_in_will" AS "consider_charity_in_will", "a_3"."email_opt_in" AS "email_opt_in", "a_3"."giving_reason_arc_was_there_for_me" AS "giving_reason_arc_was_there_for_me", "a_3"."giving_reason_provide_general_support" AS "giving_reason_provide_general_support", "a_3"."giving_reason_respond_to_local_or_national_disasters_or_emergencies" AS "giving_reason_respond_to_local_or_national_disasters_or_emergencies", "a_3"."giving_reason_tax_purposes" AS "giving_reason_tax_purposes", "a_3"."giving_reason_believe_in_arc_mission" AS "giving_reason_believe_in_arc_mission", "a_3"."giving_reason_frnd_fmly_mbr_suprtr" AS "giving_reason_frnd_fmly_mbr_suprtr", "a_3"."influential_person_in_your_life" AS "influential_person_in_your_life", "a_3"."has_the_arc_brought_hope_and_help_to_your_family_or_community" AS "has_the_arc_brought_hope_and_help_to_your_family_or_community", "a_3"."arc_programs_health_safety_education" AS "arc_programs_health_safety_education", "a_3"."arc_programs_support_for_armed_forces" AS "arc_programs_support_for_armed_forces", "a_3"."arc_programs_blood_services" AS "arc_programs_blood_services", "a_3"."arc_programs_domestic_disaster_relief" AS "arc_programs_domestic_disaster_relief", "a_3"."arc_programs_international_relief" AS "arc_programs_international_relief", "a_3"."arc_programs_important_to_provide_arc_services_in_future" AS "arc_programs_important_to_provide_arc_services_in_future", "a_3"."means_of_support_check_credit_card" AS "means_of_support_check_credit_card", "a_3"."means_of_support_volunteering" AS "means_of_support_volunteering", "a_3"."means_of_support_gift_in_your_will" AS "means_of_support_gift_in_your_will", "a_3"."means_of_support_gift_in_your_will_honoring_a_loved_one" AS "means_of_support_gift_in_your_will_honoring_a_loved_one", "a_3"."means_of_support_beneficiary_designation" AS "means_of_support_beneficiary_designation", "a_3"."means_of_support_gift_ira_chrtbl_dstrbtn" AS "means_of_support_gift_ira_chrtbl_dstrbtn", "a_3"."means_of_support_blood_donation" AS "means_of_support_blood_donation", "a_3"."means_of_support_gifts_that_pay_you_income_for_life" AS "means_of_support_gifts_that_pay_you_income_for_life", "a_3"."means_of_support_gifts_of_other_assets_stock_real_estate_bank_acct" AS "means_of_support_gifts_of_other_assets_stock_real_estate_bank_acct", "a_3"."marital_status" AS "marital_status", "a_3"."chldrn" AS "chldrn", "a_3"."grndchldrn" AS "grndchldrn", "a_3"."arc_story" AS "arc_story", "a_3"."age" AS "age", "a_3"."cds_image_id" AS "cds_image_id", "a_3"."gift_typ" AS "gift_typ", "a_3"."gift_created_dt_src" AS "gift_created_dt_src", "a_3"."gift_created_dt" AS "gift_created_dt", "a_3"."dcmnt_created_dt_src" AS "dcmnt_created_dt_src", "a_3"."dcmnt_created_dt" AS "dcmnt_created_dt", "a_3"."est_gift_value_amt" AS "est_gift_value_amt", "a_3"."gift_value_typ" AS "gift_value_typ", "a_3"."plan_typ" AS "plan_typ", "a_3"."contigent_lvl" AS "contigent_lvl", "a_3"."message" AS "message", "a_3"."don_ext_id" AS "don_ext_id", "a_3"."frwl_gift_id" AS "frwl_gift_id", "a_3"."asset_type" AS "asset_type", "a_3"."fincl_inst" AS "fincl_inst", "a_3"."prfrd_nm" AS "prfrd_nm", "a_3"."chng_made_dt_src" AS "chng_made_dt_src", "a_3"."chng_made_dt" AS "chng_made_dt", "a_3"."old_gift_value_amt" AS "old_gift_value_amt", "a_3"."new_gift_value_amt" AS "new_gift_value_amt", "a_3"."jnt_gft_ind" AS "jnt_gft_ind", "a_3"."addtnl_nm" AS "addtnl_nm", "a_3"."anmty_ind" AS "anmty_ind", "a_3"."gft_vhcl_dsc" AS "gft_vhcl_dsc", "a_3"."dsgntn_dsc" AS "dsgntn_dsc", "a_3"."gft_cmnts" AS "gft_cmnts", "a_3"."mds_pg_response_typ" AS "mds_pg_response_typ", "a_3"."hist_seqnum" AS "hist_seqnum", "a_3"."history_record_id" AS "history_record_id", "a_3"."pgc_response_id" AS "pgc_response_id", "a_3"."mds_unq_id" AS "mds_unq_id", "a_3"."rcrdg_file_nm" AS "rcrdg_file_nm", "a_3"."curr_prcsd_file_nm" AS "curr_prcsd_file_nm", "a_3"."last_match_proc_dt" AS "last_match_proc_dt", "a_3"."stuart_list_proc_dt" AS "stuart_list_proc_dt", "a_3"."dw_trans_ts" AS "dw_trans_ts", CASE WHEN "c_3"."email_addr" IS NOT NULL THEN CAST('L' AS BPCHAR) ELSE "a_3"."row_stat_cd" END AS "row_stat_cd", "a_3"."appl_src_cd" AS "appl_src_cd", "a_3"."load_id" AS "load_id" FROM ("mktg_ops_tbls"."bzfc_pg_response_log" AS "a_3" LEFT JOIN "mktg_ops_vws"."bzfc_pg_response_log_ref" AS "b_3" ON ("a_3"."hist_seqnum" = "b_3"."hist_seqnum") AND ("a_3"."appl_src_cd" = "b_3"."appl_src_cd")) LEFT JOIN "mktg_ops_vws"."bz_pg_response_log_exclusion" AS "c_3" ON "a_3"."clnsd_email_addr" = "c_3"."email_addr" WHERE ("a_3"."appl_src_cd" = CAST('HIST' AS TEXT)) AND "a_3"."cds_image_id" IS NULL QUALIFY ROW_NUMBER() OVER (PARTITION BY "a_3"."hist_seqnum" ORDER BY "a_3"."dw_trans_ts" ASC NULLS LAST) = CAST(1 AS INT4))) UNION ALL (SELECT "b_4"."pg_response_log_key" AS "pg_response_log_key", "a_4"."clnsd_first_nm" AS "clnsd_first_nm", "a_4"."clnsd_last_nm" AS "clnsd_last_nm", "a_4"."clnsd_email_addr" AS "clnsd_email_addr", "a_4"."derived_campaign" AS "derived_campaign", "a_4"."first_response_dt" AS "first_response_dt", "a_4"."response_group_dsc" AS "response_group_dsc", "a_4"."response_cnt" AS "response_cnt", "a_4"."first_response_ts" AS "first_response_ts", "a_4"."match_lob_src" AS "match_lob_src", "a_4"."match_typ" AS "match_typ", "a_4"."cds_batch_number" AS "cds_batch_number", "a_4"."cds_sequence_number" AS "cds_sequence_number", "a_4"."response_ts_src" AS "response_ts_src", "a_4"."response_ts" AS "response_ts", "a_4"."response_dt" AS "response_dt", "a_4"."site_url" AS "site_url", CAST(CASE WHEN (pg_catalog.POSITION(BTRIM("a_4"."site_url"), CAST('source=' AS TEXT)) = CAST(0 AS INT4)) THEN CAST(NULL AS TEXT) ELSE pg_catalog.SUBSTRING(pg_catalog.SUBSTRING(BTRIM("a_4"."site_url"), pg_catalog.POSITION(BTRIM("a_4"."site_url"), CAST('source=' AS TEXT))), CAST(8 AS INT4), CASE WHEN (pg_catalog.POSITION(pg_catalog.SUBSTRING(BTRIM("a_4"."site_url"), pg_catalog.POSITION(BTRIM("a_4"."site_url"), CAST('source=' AS TEXT))), CAST('&' AS TEXT)) = CAST(0 AS INT4)) THEN CAST(10 AS INT4) ELSE (pg_catalog.POSITION(pg_catalog.SUBSTRING(BTRIM("a_4"."site_url"), pg_catalog.POSITION(BTRIM("a_4"."site_url"), CAST('source=' AS TEXT))), CAST('&' AS TEXT)) - CAST(8 AS INT4)) END) END AS VARCHAR) AS "site_src", "a_4"."lander_type" AS "lander_type", "a_4"."nk_ecode" AS "nk_ecode", "a_4"."src_cd_src" AS "src_cd_src", CASE WHEN (("a_4"."scr_cd" = CAST('APP20091M000' AS TEXT)) AND ("a_4"."response_dt" >= CAST('2021-09-07' AS DATE))) THEN CAST('APP21091M000' AS VARCHAR) WHEN (("a_4"."scr_cd" = CAST('APP2308AE000' AS TEXT)) AND ("a_4"."response_dt" >= CAST('2024-07-31' AS DATE))) THEN CAST('APP2408AE000' AS VARCHAR) WHEN (("a_4"."scr_cd" = CAST('APP18092M000' AS TEXT)) AND ("a_4"."response_dt" >= CAST('2024-07-31' AS DATE))) THEN CAST('APP24082M000' AS VARCHAR) WHEN (("a_4"."scr_cd" = CAST('APP23082E000' AS TEXT)) AND ("a_4"."response_dt" >= CAST('2024-07-31' AS DATE))) THEN CAST('APP24082E000' AS VARCHAR) ELSE "a_4"."scr_cd" END AS "scr_cd", "a_4"."cnst_mstr_id_src" AS "cnst_mstr_id_src", "a_4"."cnst_mstr_id" AS "cnst_mstr_id", "a_4"."orig_cnst_mstr_id" AS "orig_cnst_mstr_id", "a_4"."ttl" AS "ttl", "a_4"."first_nm" AS "first_nm", "a_4"."middle_nm" AS "middle_nm", "a_4"."last_nm" AS "last_nm", "a_4"."sfx" AS "sfx", "a_4"."prf_ttl" AS "prf_ttl", "a_4"."cmpny_nm" AS "cmpny_nm", "a_4"."birth_dt_src" AS "birth_dt_src", CASE WHEN ((pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_4"."birth_dt") >= CAST(0 AS INT4)) AND (pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_4"."birth_dt") <= CAST(99 AS INT4))) THEN ADD_MONTHS("a_4"."birth_dt", CAST(22800 AS INT4)) ELSE "a_4"."birth_dt" END AS "birth_dt", "a_4"."spouse_birth_dt_src" AS "spouse_birth_dt_src", CASE WHEN ((pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_4"."spouse_birth_dt") >= CAST(0 AS INT4)) AND (pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_4"."spouse_birth_dt") <= CAST(99 AS INT4))) THEN ADD_MONTHS("a_4"."spouse_birth_dt", CAST(22800 AS INT4)) ELSE "a_4"."spouse_birth_dt" END AS "spouse_birth_dt", "a_4"."addr_ln1" AS "addr_ln1", "a_4"."addr_ln2" AS "addr_ln2", "a_4"."addr_ln3" AS "addr_ln3", "a_4"."city" AS "city", "a_4"."state" AS "state", "a_4"."zip_cd" AS "zip_cd", "a_4"."phone_num" AS "phone_num", "a_4"."phone_mobile_ind" AS "phone_mobile_ind", "a_4"."phone_home_ind" AS "phone_home_ind", "a_4"."email_addr" AS "email_addr", "a_4"."cntct_prfrnc" AS "cntct_prfrnc", COALESCE("a_4"."cntct_prfrnc_phone_ind", CAST(0 AS INT4)) AS "cntct_prfrnc_phone_ind", COALESCE("a_4"."cntct_prfrnc_text_ind", CAST(0 AS INT4)) AS "cntct_prfrnc_text_ind", COALESCE("a_4"."cntct_prfrnc_email_ind", CAST(0 AS INT4)) AS "cntct_prfrnc_email_ind", "a_4"."cdrp_pg_info_request_pg_information" AS "cdrp_pg_info_request_pg_information", "a_4"."cdrp_pg_confirm_arc_in_will" AS "cdrp_pg_confirm_arc_in_will", "a_4"."cga_age_payments_begin" AS "cga_age_payments_begin", "a_4"."cga_5000" AS "cga_5000", "a_4"."cga_10000" AS "cga_10000", "a_4"."cga_50000" AS "cga_50000", "a_4"."cga_100000" AS "cga_100000", "a_4"."cga_other" AS "cga_other", "a_4"."cga_fdbk" AS "cga_fdbk", "a_4"."wg_rqst" AS "wg_rqst", "a_4"."wg_arc_in_will" AS "wg_arc_in_will", "a_4"."wg_intend_arc_in_will" AS "wg_intend_arc_in_will", "a_4"."wg_consider_arc_in_will" AS "wg_consider_arc_in_will", "a_4"."wg_fdbk" AS "wg_fdbk", "a_4"."interest_in_life_income_gift_w_stock" AS "interest_in_life_income_gift_w_stock", "a_4"."interest_in_life_income_gift_w_real_estate" AS "interest_in_life_income_gift_w_real_estate", "a_4"."interest_in_life_income_gift_w_ira" AS "interest_in_life_income_gift_w_ira", "a_4"."interest_in_gift_in_will" AS "interest_in_gift_in_will", "a_4"."interest_in_gift_outside_will" AS "interest_in_gift_outside_will", "a_4"."interest_in_life_income_gifts" AS "interest_in_life_income_gifts", "a_4"."interest_in_ira_qcd_gifts" AS "interest_in_ira_qcd_gifts", "a_4"."consider_charity_in_will" AS "consider_charity_in_will", "a_4"."email_opt_in" AS "email_opt_in", "a_4"."giving_reason_arc_was_there_for_me" AS "giving_reason_arc_was_there_for_me", "a_4"."giving_reason_provide_general_support" AS "giving_reason_provide_general_support", "a_4"."giving_reason_respond_to_local_or_national_disasters_or_emergencies" AS "giving_reason_respond_to_local_or_national_disasters_or_emergencies", "a_4"."giving_reason_tax_purposes" AS "giving_reason_tax_purposes", "a_4"."giving_reason_believe_in_arc_mission" AS "giving_reason_believe_in_arc_mission", "a_4"."giving_reason_frnd_fmly_mbr_suprtr" AS "giving_reason_frnd_fmly_mbr_suprtr", "a_4"."influential_person_in_your_life" AS "influential_person_in_your_life", "a_4"."has_the_arc_brought_hope_and_help_to_your_family_or_community" AS "has_the_arc_brought_hope_and_help_to_your_family_or_community", "a_4"."arc_programs_health_safety_education" AS "arc_programs_health_safety_education", "a_4"."arc_programs_support_for_armed_forces" AS "arc_programs_support_for_armed_forces", "a_4"."arc_programs_blood_services" AS "arc_programs_blood_services", "a_4"."arc_programs_domestic_disaster_relief" AS "arc_programs_domestic_disaster_relief", "a_4"."arc_programs_international_relief" AS "arc_programs_international_relief", "a_4"."arc_programs_important_to_provide_arc_services_in_future" AS "arc_programs_important_to_provide_arc_services_in_future", "a_4"."means_of_support_check_credit_card" AS "means_of_support_check_credit_card", "a_4"."means_of_support_volunteering" AS "means_of_support_volunteering", "a_4"."means_of_support_gift_in_your_will" AS "means_of_support_gift_in_your_will", "a_4"."means_of_support_gift_in_your_will_honoring_a_loved_one" AS "means_of_support_gift_in_your_will_honoring_a_loved_one", "a_4"."means_of_support_beneficiary_designation" AS "means_of_support_beneficiary_designation", "a_4"."means_of_support_gift_ira_chrtbl_dstrbtn" AS "means_of_support_gift_ira_chrtbl_dstrbtn", "a_4"."means_of_support_blood_donation" AS "means_of_support_blood_donation", "a_4"."means_of_support_gifts_that_pay_you_income_for_life" AS "means_of_support_gifts_that_pay_you_income_for_life", "a_4"."means_of_support_gifts_of_other_assets_stock_real_estate_bank_acct" AS "means_of_support_gifts_of_other_assets_stock_real_estate_bank_acct", "a_4"."marital_status" AS "marital_status", "a_4"."chldrn" AS "chldrn", "a_4"."grndchldrn" AS "grndchldrn", "a_4"."arc_story" AS "arc_story", "a_4"."age" AS "age", "a_4"."cds_image_id" AS "cds_image_id", "a_4"."gift_typ" AS "gift_typ", "a_4"."gift_created_dt_src" AS "gift_created_dt_src", "a_4"."gift_created_dt" AS "gift_created_dt", "a_4"."dcmnt_created_dt_src" AS "dcmnt_created_dt_src", "a_4"."dcmnt_created_dt" AS "dcmnt_created_dt", "a_4"."est_gift_value_amt" AS "est_gift_value_amt", "a_4"."gift_value_typ" AS "gift_value_typ", "a_4"."plan_typ" AS "plan_typ", "a_4"."contigent_lvl" AS "contigent_lvl", "a_4"."message" AS "message", "a_4"."don_ext_id" AS "don_ext_id", "a_4"."frwl_gift_id" AS "frwl_gift_id", "a_4"."asset_type" AS "asset_type", "a_4"."fincl_inst" AS "fincl_inst", "a_4"."prfrd_nm" AS "prfrd_nm", "a_4"."chng_made_dt_src" AS "chng_made_dt_src", "a_4"."chng_made_dt" AS "chng_made_dt", "a_4"."old_gift_value_amt" AS "old_gift_value_amt", "a_4"."new_gift_value_amt" AS "new_gift_value_amt", "a_4"."jnt_gft_ind" AS "jnt_gft_ind", "a_4"."addtnl_nm" AS "addtnl_nm", "a_4"."anmty_ind" AS "anmty_ind", "a_4"."gft_vhcl_dsc" AS "gft_vhcl_dsc", "a_4"."dsgntn_dsc" AS "dsgntn_dsc", "a_4"."gft_cmnts" AS "gft_cmnts", "a_4"."mds_pg_response_typ" AS "mds_pg_response_typ", "a_4"."hist_seqnum" AS "hist_seqnum", "a_4"."history_record_id" AS "history_record_id", "a_4"."pgc_response_id" AS "pgc_response_id", "a_4"."mds_unq_id" AS "mds_unq_id", "a_4"."rcrdg_file_nm" AS "rcrdg_file_nm", "a_4"."curr_prcsd_file_nm" AS "curr_prcsd_file_nm", "a_4"."last_match_proc_dt" AS "last_match_proc_dt", "a_4"."stuart_list_proc_dt" AS "stuart_list_proc_dt", "a_4"."dw_trans_ts" AS "dw_trans_ts", CASE WHEN "c_4"."email_addr" IS NOT NULL THEN CAST('L' AS BPCHAR) ELSE "a_4"."row_stat_cd" END AS "row_stat_cd", "a_4"."appl_src_cd" AS "appl_src_cd", "a_4"."load_id" AS "load_id" FROM ("mktg_ops_tbls"."bzfc_pg_response_log" AS "a_4" LEFT JOIN "mktg_ops_vws"."bzfc_pg_response_log_ref" AS "b_4" ON ((((((((("a_4"."first_response_dt" = "b_4"."first_response_dt") OR ("a_4"."first_response_dt" IS NULL AND "b_4"."first_response_dt" IS NULL)) AND (("a_4"."clnsd_first_nm" = "b_4"."clnsd_first_nm") OR ("a_4"."clnsd_first_nm" IS NULL AND "b_4"."clnsd_first_nm" IS NULL))) AND (("a_4"."clnsd_last_nm" = "b_4"."clnsd_last_nm") OR ("a_4"."clnsd_last_nm" IS NULL AND "b_4"."clnsd_last_nm" IS NULL))) AND (("a_4"."clnsd_email_addr" = "b_4"."clnsd_email_addr") OR ("a_4"."clnsd_email_addr" IS NULL AND "b_4"."clnsd_email_addr" IS NULL))) AND (("a_4"."derived_campaign" = "b_4"."derived_campaign") OR ("a_4"."derived_campaign" IS NULL AND "b_4"."derived_campaign" IS NULL))) AND (("a_4"."response_group_dsc" = "b_4"."response_group_dsc") OR ("a_4"."response_group_dsc" IS NULL AND "b_4"."response_group_dsc" IS NULL))) AND (("a_4"."cds_image_id" = "b_4"."cds_image_id") OR ("a_4"."cds_image_id" IS NULL AND "b_4"."cds_image_id" IS NULL))) AND (("a_4"."pgc_response_id" = "b_4"."pgc_response_id") OR ("a_4"."pgc_response_id" IS NULL AND "b_4"."pgc_response_id" IS NULL))) OR ((("a_4"."pgc_response_id" <> CAST(0 AS INT4)) AND (("a_4"."pgc_response_id" = "b_4"."pgc_response_id") OR ("a_4"."pgc_response_id" IS NULL AND "b_4"."pgc_response_id" IS NULL))) AND ("a_4"."appl_src_cd" = "b_4"."appl_src_cd"))) LEFT JOIN "mktg_ops_vws"."bz_pg_response_log_exclusion" AS "c_4" ON "a_4"."clnsd_email_addr" = "c_4"."email_addr" WHERE "a_4"."appl_src_cd" = CAST('PGC' AS TEXT))) UNION ALL (SELECT "b_5"."pg_response_log_key" AS "pg_response_log_key", "a_5"."clnsd_first_nm" AS "clnsd_first_nm", "a_5"."clnsd_last_nm" AS "clnsd_last_nm", "a_5"."clnsd_email_addr" AS "clnsd_email_addr", "a_5"."derived_campaign" AS "derived_campaign", "a_5"."first_response_dt" AS "first_response_dt", "a_5"."response_group_dsc" AS "response_group_dsc", "a_5"."response_cnt" AS "response_cnt", "a_5"."first_response_ts" AS "first_response_ts", "a_5"."match_lob_src" AS "match_lob_src", "a_5"."match_typ" AS "match_typ", "a_5"."cds_batch_number" AS "cds_batch_number", "a_5"."cds_sequence_number" AS "cds_sequence_number", "a_5"."response_ts_src" AS "response_ts_src", "a_5"."response_ts" AS "response_ts", "a_5"."response_dt" AS "response_dt", "a_5"."site_url" AS "site_url", CAST(CASE WHEN (pg_catalog.POSITION(BTRIM("a_5"."site_url"), CAST('source=' AS TEXT)) = CAST(0 AS INT4)) THEN CAST(NULL AS TEXT) ELSE pg_catalog.SUBSTRING(pg_catalog.SUBSTRING(BTRIM("a_5"."site_url"), pg_catalog.POSITION(BTRIM("a_5"."site_url"), CAST('source=' AS TEXT))), CAST(8 AS INT4), CASE WHEN (pg_catalog.POSITION(pg_catalog.SUBSTRING(BTRIM("a_5"."site_url"), pg_catalog.POSITION(BTRIM("a_5"."site_url"), CAST('source=' AS TEXT))), CAST('&' AS TEXT)) = CAST(0 AS INT4)) THEN CAST(10 AS INT4) ELSE (pg_catalog.POSITION(pg_catalog.SUBSTRING(BTRIM("a_5"."site_url"), pg_catalog.POSITION(BTRIM("a_5"."site_url"), CAST('source=' AS TEXT))), CAST('&' AS TEXT)) - CAST(8 AS INT4)) END) END AS VARCHAR) AS "site_src", "a_5"."lander_type" AS "lander_type", "a_5"."nk_ecode" AS "nk_ecode", "a_5"."src_cd_src" AS "src_cd_src", CASE WHEN (("a_5"."scr_cd" = CAST('APP20091M000' AS TEXT)) AND ("a_5"."response_dt" >= CAST('2021-09-07' AS DATE))) THEN CAST('APP21091M000' AS VARCHAR) WHEN (("a_5"."scr_cd" = CAST('APP2308AE000' AS TEXT)) AND ("a_5"."response_dt" >= CAST('2024-07-31' AS DATE))) THEN CAST('APP2408AE000' AS VARCHAR) WHEN (("a_5"."scr_cd" = CAST('APP18092M000' AS TEXT)) AND ("a_5"."response_dt" >= CAST('2024-07-31' AS DATE))) THEN CAST('APP24082M000' AS VARCHAR) WHEN (("a_5"."scr_cd" = CAST('APP23082E000' AS TEXT)) AND ("a_5"."response_dt" >= CAST('2024-07-31' AS DATE))) THEN CAST('APP24082E000' AS VARCHAR) ELSE "a_5"."scr_cd" END AS "scr_cd", "a_5"."cnst_mstr_id_src" AS "cnst_mstr_id_src", "a_5"."cnst_mstr_id" AS "cnst_mstr_id", "a_5"."orig_cnst_mstr_id" AS "orig_cnst_mstr_id", "a_5"."ttl" AS "ttl", "a_5"."first_nm" AS "first_nm", "a_5"."middle_nm" AS "middle_nm", "a_5"."last_nm" AS "last_nm", "a_5"."sfx" AS "sfx", "a_5"."prf_ttl" AS "prf_ttl", "a_5"."cmpny_nm" AS "cmpny_nm", "a_5"."birth_dt_src" AS "birth_dt_src", CASE WHEN ((pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_5"."birth_dt") >= CAST(0 AS INT4)) AND (pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_5"."birth_dt") <= CAST(99 AS INT4))) THEN ADD_MONTHS("a_5"."birth_dt", CAST(22800 AS INT4)) ELSE "a_5"."birth_dt" END AS "birth_dt", "a_5"."spouse_birth_dt_src" AS "spouse_birth_dt_src", CASE WHEN ((pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_5"."spouse_birth_dt") >= CAST(0 AS INT4)) AND (pg_catalog.DATE_PART(CAST('year' AS TEXT), "a_5"."spouse_birth_dt") <= CAST(99 AS INT4))) THEN ADD_MONTHS("a_5"."spouse_birth_dt", CAST(22800 AS INT4)) ELSE "a_5"."spouse_birth_dt" END AS "spouse_birth_dt", "a_5"."addr_ln1" AS "addr_ln1", "a_5"."addr_ln2" AS "addr_ln2", "a_5"."addr_ln3" AS "addr_ln3", "a_5"."city" AS "city", "a_5"."state" AS "state", "a_5"."zip_cd" AS "zip_cd", "a_5"."phone_num" AS "phone_num", "a_5"."phone_mobile_ind" AS "phone_mobile_ind", "a_5"."phone_home_ind" AS "phone_home_ind", "a_5"."email_addr" AS "email_addr", "a_5"."cntct_prfrnc" AS "cntct_prfrnc", COALESCE("a_5"."cntct_prfrnc_phone_ind", CAST(0 AS INT4)) AS "cntct_prfrnc_phone_ind", COALESCE("a_5"."cntct_prfrnc_text_ind", CAST(0 AS INT4)) AS "cntct_prfrnc_text_ind", COALESCE("a_5"."cntct_prfrnc_email_ind", CAST(0 AS INT4)) AS "cntct_prfrnc_email_ind", "a_5"."cdrp_pg_info_request_pg_information" AS "cdrp_pg_info_request_pg_information", "a_5"."cdrp_pg_confirm_arc_in_will" AS "cdrp_pg_confirm_arc_in_will", "a_5"."cga_age_payments_begin" AS "cga_age_payments_begin", "a_5"."cga_5000" AS "cga_5000", "a_5"."cga_10000" AS "cga_10000", "a_5"."cga_50000" AS "cga_50000", "a_5"."cga_100000" AS "cga_100000", "a_5"."cga_other" AS "cga_other", "a_5"."cga_fdbk" AS "cga_fdbk", "a_5"."wg_rqst" AS "wg_rqst", "a_5"."wg_arc_in_will" AS "wg_arc_in_will", "a_5"."wg_intend_arc_in_will" AS "wg_intend_arc_in_will", "a_5"."wg_consider_arc_in_will" AS "wg_consider_arc_in_will", "a_5"."wg_fdbk" AS "wg_fdbk", "a_5"."interest_in_life_income_gift_w_stock" AS "interest_in_life_income_gift_w_stock", "a_5"."interest_in_life_income_gift_w_real_estate" AS "interest_in_life_income_gift_w_real_estate", "a_5"."interest_in_life_income_gift_w_ira" AS "interest_in_life_income_gift_w_ira", "a_5"."interest_in_gift_in_will" AS "interest_in_gift_in_will", "a_5"."interest_in_gift_outside_will" AS "interest_in_gift_outside_will", "a_5"."interest_in_life_income_gifts" AS "interest_in_life_income_gifts", "a_5"."interest_in_ira_qcd_gifts" AS "interest_in_ira_qcd_gifts", "a_5"."consider_charity_in_will" AS "consider_charity_in_will", "a_5"."email_opt_in" AS "email_opt_in", "a_5"."giving_reason_arc_was_there_for_me" AS "giving_reason_arc_was_there_for_me", "a_5"."giving_reason_provide_general_support" AS "giving_reason_provide_general_support", "a_5"."giving_reason_respond_to_local_or_national_disasters_or_emergencies" AS "giving_reason_respond_to_local_or_national_disasters_or_emergencies", "a_5"."giving_reason_tax_purposes" AS "giving_reason_tax_purposes", "a_5"."giving_reason_believe_in_arc_mission" AS "giving_reason_believe_in_arc_mission", "a_5"."giving_reason_frnd_fmly_mbr_suprtr" AS "giving_reason_frnd_fmly_mbr_suprtr", "a_5"."influential_person_in_your_life" AS "influential_person_in_your_life", "a_5"."has_the_arc_brought_hope_and_help_to_your_family_or_community" AS "has_the_arc_brought_hope_and_help_to_your_family_or_community", "a_5"."arc_programs_health_safety_education" AS "arc_programs_health_safety_education", "a_5"."arc_programs_support_for_armed_forces" AS "arc_programs_support_for_armed_forces", "a_5"."arc_programs_blood_services" AS "arc_programs_blood_services", "a_5"."arc_programs_domestic_disaster_relief" AS "arc_programs_domestic_disaster_relief", "a_5"."arc_programs_international_relief" AS "arc_programs_international_relief", "a_5"."arc_programs_important_to_provide_arc_services_in_future" AS "arc_programs_important_to_provide_arc_services_in_future", "a_5"."means_of_support_check_credit_card" AS "means_of_support_check_credit_card", "a_5"."means_of_support_volunteering" AS "means_of_support_volunteering", "a_5"."means_of_support_gift_in_your_will" AS "means_of_support_gift_in_your_will", "a_5"."means_of_support_gift_in_your_will_honoring_a_loved_one" AS "means_of_support_gift_in_your_will_honoring_a_loved_one", "a_5"."means_of_support_beneficiary_designation" AS "means_of_support_beneficiary_designation", "a_5"."means_of_support_gift_ira_chrtbl_dstrbtn" AS "means_of_support_gift_ira_chrtbl_dstrbtn", "a_5"."means_of_support_blood_donation" AS "means_of_support_blood_donation", "a_5"."means_of_support_gifts_that_pay_you_income_for_life" AS "means_of_support_gifts_that_pay_you_income_for_life", "a_5"."means_of_support_gifts_of_other_assets_stock_real_estate_bank_acct" AS "means_of_support_gifts_of_other_assets_stock_real_estate_bank_acct", "a_5"."marital_status" AS "marital_status", "a_5"."chldrn" AS "chldrn", "a_5"."grndchldrn" AS "grndchldrn", "a_5"."arc_story" AS "arc_story", "a_5"."age" AS "age", "a_5"."cds_image_id" AS "cds_image_id", "a_5"."gift_typ" AS "gift_typ", "a_5"."gift_created_dt_src" AS "gift_created_dt_src", "a_5"."gift_created_dt" AS "gift_created_dt", "a_5"."dcmnt_created_dt_src" AS "dcmnt_created_dt_src", "a_5"."dcmnt_created_dt" AS "dcmnt_created_dt", "a_5"."est_gift_value_amt" AS "est_gift_value_amt", "a_5"."gift_value_typ" AS "gift_value_typ", "a_5"."plan_typ" AS "plan_typ", "a_5"."contigent_lvl" AS "contigent_lvl", "a_5"."message" AS "message", "a_5"."don_ext_id" AS "don_ext_id", "a_5"."frwl_gift_id" AS "frwl_gift_id", "a_5"."asset_type" AS "asset_type", "a_5"."fincl_inst" AS "fincl_inst", "a_5"."prfrd_nm" AS "prfrd_nm", "a_5"."chng_made_dt_src" AS "chng_made_dt_src", "a_5"."chng_made_dt" AS "chng_made_dt", "a_5"."old_gift_value_amt" AS "old_gift_value_amt", "a_5"."new_gift_value_amt" AS "new_gift_value_amt", "a_5"."jnt_gft_ind" AS "jnt_gft_ind", "a_5"."addtnl_nm" AS "addtnl_nm", "a_5"."anmty_ind" AS "anmty_ind", "a_5"."gft_vhcl_dsc" AS "gft_vhcl_dsc", "a_5"."dsgntn_dsc" AS "dsgntn_dsc", "a_5"."gft_cmnts" AS "gft_cmnts", "a_5"."mds_pg_response_typ" AS "mds_pg_response_typ", "a_5"."hist_seqnum" AS "hist_seqnum", "a_5"."history_record_id" AS "history_record_id", "a_5"."pgc_response_id" AS "pgc_response_id", "a_5"."mds_unq_id" AS "mds_unq_id", "a_5"."rcrdg_file_nm" AS "rcrdg_file_nm", "a_5"."curr_prcsd_file_nm" AS "curr_prcsd_file_nm", "a_5"."last_match_proc_dt" AS "last_match_proc_dt", "a_5"."stuart_list_proc_dt" AS "stuart_list_proc_dt", "a_5"."dw_trans_ts" AS "dw_trans_ts", CASE WHEN ("c_5"."email_addr" IS NOT NULL OR ("a_5"."response_dt" <= CAST('2024-04-05' AS DATE))) THEN CAST('L' AS BPCHAR) ELSE "a_5"."row_stat_cd" END AS "row_stat_cd", "a_5"."appl_src_cd" AS "appl_src_cd", "a_5"."load_id" AS "load_id" FROM ("mktg_ops_tbls"."bzfc_pg_response_log" AS "a_5" LEFT JOIN "mktg_ops_vws"."bzfc_pg_response_log_ref" AS "b_5" ON ("a_5"."mds_unq_id" = "b_5"."mds_unq_id") AND ("a_5"."appl_src_cd" = "b_5"."appl_src_cd")) LEFT JOIN "mktg_ops_vws"."bz_pg_response_log_exclusion" AS "c_5" ON "a_5"."clnsd_email_addr" = "c_5"."email_addr" WHERE "a_5"."appl_src_cd" = CAST('MDS' AS TEXT) QUALIFY ROW_NUMBER() OVER (PARTITION BY "a_5"."mds_unq_id" ORDER BY "a_5"."dw_trans_ts" ASC NULLS LAST) = CAST(1 AS INT4)) WITH NO SCHEMA BINDING;